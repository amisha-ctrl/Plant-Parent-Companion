"use strict";(self.webpackChunkforest_atlas_template=self.webpackChunkforest_atlas_template||[]).push([[322],{161:(e,t,r)=>{var n,o,i;r.d(t,{O7:()=>o,Om:()=>n,sv:()=>i}),function(e){e[e.RasterImage=0]="RasterImage",e[e.Features=1]="Features"}(n||(n={})),function(e){e[e.MapLayer=0]="MapLayer",e[e.ViewLayer=1]="ViewLayer",e[e.Outline=2]="Outline",e[e.SnappingHint=3]="SnappingHint"}(o||(o={})),function(e){e[e.WithRasterImage=0]="WithRasterImage",e[e.WithoutRasterImage=1]="WithoutRasterImage"}(i||(i={}))},2568:(e,t,r)=>{r.d(t,{R1:()=>a,aY:()=>o,cN:()=>i});var n=r(75423);class o{constructor(e,t=null,r=0){this.array=e,this.spatialReference=t,this.offset=r}}function i(e){return"array"in e}function a(e,t,r="ground"){if((0,n.v)(t))return e.getElevation(t.x,t.y,t.z||0,t.spatialReference,r);if(i(t)){let n=t.offset;return e.getElevation(t.array[n++],t.array[n++],t.array[n]||0,t.spatialReference??e.spatialReference,r)}return e.getElevation(t[0],t[1],t[2]||0,e.spatialReference,r)}},4498:(e,t,r)=>{r.d(t,{Cz:()=>o,DZ:()=>a,PV:()=>i,vO:()=>n}),r(11519),r(68716),r(22497),r(88416);const n=64,o=n/2,i=n/(o/5),a=.25},5415:(e,t,r)=>{r.d(t,{x:()=>p});var n=r(57888),o=r(56802),i=r(57725),a=r(41785),s=r(73411),l=r(61723);const c=["layerObjectAdded","layerObjectRemoved","layerObjectsAdded","layerObjectsRemoved","transformationChanged","shaderTransformationChanged","visibilityChanged","occlusionChanged","highlightChanged","geometryAdded","geometryRemoved","attributesChanged"];var d=r(935),u=r(34402);class p extends s.J{constructor(e,t,r=""){super(),this.stage=e,this.apiLayerUid=r,this.type=l.X.Layer,this.events=new n.A,this.visible=!0,this.sliceable=!1,this._objectsAdded=new a.A,this._handles=new o.A,this._objects=new a.A,this._pickable=!0,this.visible=t?.visible??!0,this._pickable=t?.pickable??!0,this.updatePolicy=t?.updatePolicy??u.q.ASYNC,this._disableOctree=t?.disableOctree??!1,e.add(this);for(const t of c)this._handles.add(this.events.on(t,(r=>e.handleEvent(t,r))))}destroy(){this._handles.size&&(this._handles.destroy(),this.stage.remove(this),this.invalidateSpatialQueryAccelerator())}get objects(){return this._objects}set pickable(e){this._pickable=e}get pickable(){return this._pickable&&this.visible}add(e){this._objects.push(e),e.parentLayer=this,this.events.emit("layerObjectAdded",{layer:this,object:e}),null!=this._octree&&this._objectsAdded.push(e)}remove(e){this._objects.removeUnordered(e)&&(e.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:e}),null!=this._octree&&(this._objectsAdded.removeUnordered(e)||this._octree.remove([e])))}addMany(e){this._objects.pushArray(e);for(const t of e)t.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:e}),null!=this._octree&&this._objectsAdded.pushArray(e)}removeMany(e){const t=new Array;if(this._objects.removeUnorderedMany(e,e.length,t),0!==t.length){for(const e of t)e.parentLayer=null;if(this.events.emit("layerObjectsRemoved",{layer:this,objects:t}),null!=this._octree){for(let e=0;e<t.length;)this._objectsAdded.removeUnordered(t[e])?(t[e]=t[t.length-1],t.length-=1):++e;this._octree.remove(t)}}}sync(){this.updatePolicy!==u.q.SYNC&&this.stage.syncLayer(this.id)}notifyObjectBBChanged(e,t){null==this._octree||this._objectsAdded.includes(e)||this._octree.update(e,t)}getSpatialQueryAccelerator(){return null==this._octree&&this._objects.length>50&&!this._disableOctree?(this._octree=new d.A((e=>e.boundingVolumeWorldSpace.bounds)),this._octree.add(this._objects.data,this._objects.length)):null!=this._octree&&this._objectsAdded.length>0&&(this._octree.add(this._objectsAdded.data,this._objectsAdded.length),this._objectsAdded.clear()),this._octree}invalidateSpatialQueryAccelerator(){this._octree=(0,i.pR)(this._octree),this._objectsAdded.clear()}}},5822:(e,t,r)=>{r.d(t,{I2:()=>v,Kf:()=>y,Uk:()=>E,ai:()=>w,au:()=>h,fe:()=>_,nG:()=>m,nu:()=>g,sE:()=>f,uw:()=>n});var n,o,i=r(25336),a=r(26110),s=r(19913),l=r(63540),c=r(88133),d=r(75423),u=r(2568),p=r(33763);function h(e,t,r,n,o,i,a,s,l,d,u){const p=b[u.mode];let h,f,m=0;if((0,c.projectBuffer)(e,t,r,n,l.spatialReference,o,s))return p?.requiresAlignment(u)?(m=p.applyElevationAlignmentBuffer(n,o,i,a,s,l,d,u),h=i,f=a):(h=n,f=o),(0,c.projectBuffer)(h,l.spatialReference,f,i,d.spatialReference,a,s)?m:void 0}function f(e,t,r,n,o){const i=((0,d.v)(e)?e.z:(0,u.cN)(e)?e.array[e.offset+2]:e[2])||0;switch(r.mode){case"on-the-ground":{const r=(0,u.R1)(t,e,"ground")??0;return o.verticalDistanceToGround=0,o.sampledElevation=r,void(o.z=r)}case"relative-to-ground":{const a=(0,u.R1)(t,e,"ground")??0,s=r.geometryZWithOffset(i,n);return o.verticalDistanceToGround=s,o.sampledElevation=a,void(o.z=s+a)}case"relative-to-scene":{const a=(0,u.R1)(t,e,"scene")??0,s=r.geometryZWithOffset(i,n);return o.verticalDistanceToGround=s,o.sampledElevation=a,void(o.z=s+a)}case"absolute-height":{const a=r.geometryZWithOffset(i,n),s=(0,u.R1)(t,e,"ground")??0;return o.verticalDistanceToGround=a-s,o.sampledElevation=s,void(o.z=a)}default:return void(o.z=0)}}function m(e,t,r,n){return f(e,t,r,n,T),T.z}function v(e,t,r){return"on-the-ground"===t&&"on-the-ground"===r?e.staysOnTheGround:t===r||"on-the-ground"!==t&&"on-the-ground"!==r?null==t||null==r?e.definedChanged:n.UPDATE:e.onTheGroundChanged}function g(e){return"relative-to-ground"===e||"relative-to-scene"===e}function y(e){return"absolute-height"!==e}function _(e,t,r,n,o){f(t,r,o,n,T),w(e,T.verticalDistanceToGround);const a=T.sampledElevation,s=(0,i.C)(S,e.transformation);return A[0]=t.x,A[1]=t.y,A[2]=T.z,(0,l.l)(t.spatialReference,A,s,n.spatialReference)?e.transformation=s:console.warn("Could not locate symbol object properly, it might be misplaced"),a}function w(e,t){for(let r=0;r<e.geometries.length;++r){const n=e.geometries[r].getMutableAttribute(p.r.CENTEROFFSETANDDISTANCE);n&&n.data[3]!==t&&(n.data[3]=t,e.geometryVertexAttributeUpdated(e.geometries[r],p.r.CENTEROFFSETANDDISTANCE))}}class E{constructor(){this.verticalDistanceToGround=0,this.sampledElevation=0,this.z=0}}(o=n||(n={}))[o.NONE=0]="NONE",o[o.UPDATE=1]="UPDATE",o[o.RECREATE=2]="RECREATE";const b={"absolute-height":{applyElevationAlignmentBuffer:function(e,t,r,n,o,i,a,s){const l=s.calculateOffsetRenderUnits(a),c=s.featureExpressionInfoContext;t*=3,n*=3;for(let i=0;i<o;++i){const o=e[t],i=e[t+1],a=e[t+2];r[n]=o,r[n+1]=i,r[n+2]=null==c?a+l:l,t+=3,n+=3}return 0},requiresAlignment:function(e){const t=e.meterUnitOffset,r=e.featureExpressionInfoContext;return 0!==t||null!=r}},"on-the-ground":{applyElevationAlignmentBuffer:function(e,t,r,n,o,i){let a=0;const s=i.spatialReference;t*=3,n*=3;for(let l=0;l<o;++l){const o=e[t],l=e[t+1],c=e[t+2],d=i.getElevation(o,l,c,s,"ground")??0;a+=d,r[n]=o,r[n+1]=l,r[n+2]=d,t+=3,n+=3}return a/o},requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:function(e,t,r,n,o,i,a,s){let l=0;const c=s.calculateOffsetRenderUnits(a),d=s.featureExpressionInfoContext,u=i.spatialReference;t*=3,n*=3;for(let a=0;a<o;++a){const o=e[t],a=e[t+1],s=e[t+2],p=i.getElevation(o,a,s,u,"ground")??0;l+=p,r[n]=o,r[n+1]=a,r[n+2]=null==d?s+p+c:p+c,t+=3,n+=3}return l/o},requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:function(e,t,r,n,o,i,a,s){let l=0;const c=s.calculateOffsetRenderUnits(a),d=s.featureExpressionInfoContext,u=i.spatialReference;t*=3,n*=3;for(let a=0;a<o;++a){const o=e[t],a=e[t+1],s=e[t+2],p=i.getElevation(o,a,s,u,"scene")??0;l+=p,r[n]=o,r[n+1]=a,r[n+2]=null==d?s+p+c:p+c,t+=3,n+=3}return l/o},requiresAlignment:()=>!0}},S=(0,a.vt)(),T=new E,A=(0,s.vt)()},16596:(e,t,r)=>{r.d(t,{W:()=>j});var n=r(80861),o=r(4506),i=r(23572),a=r(53334),s=r(80347),l=r(19913),c=r(76982),d=r(74224),u=r(94669),p=r(87368),h=r(7724),f=r(77788),m=r(78546),v=r(84618),g=r(76687),y=r(31272),_=r(15449),w=r(26421),E=r(33763),b=r(34383),S=r(18994),T=r(46348),A=(r(6273),r(21979)),O=r(50837),D=r(14692),R=r(8445),C=r(28116),x=r(68716),P=r(15651);class F extends O.w{constructor(e,t,n){super(e,t,new A.$(T.R,(()=>r.e(848).then(r.bind(r,53740)))),n,L),this.primitiveType=t.wireframe?x.WR.LINES:x.WR.TRIANGLE_STRIP}_makePipelineState(e,t){const{oitPass:r,output:n,hasOccludees:o,hasPolygonOffset:i}=e,a=r===D.Y.NONE,s=r===D.Y.FrontFace;return(0,P.Ey)({blending:e.output===f.V.Color?(0,R.Yf)(r):null,depthTest:{func:(0,R.K_)(r)},depthWrite:(0,R.z5)(e),drawBuffers:n===f.V.Depth?{buffers:[x.Hr.NONE]}:(0,R.m6)(r,n),colorWrite:P.kn,stencilWrite:o?C.v0:null,stencilTest:o?t?C.a9:C.qh:null,polygonOffset:a||s?i?k:null:R.SE})}initializePipeline(e){if(e.occluder){const t=e.hasPolygonOffset?k:null;this._occluderPipelineTransparent=(0,P.Ey)({blending:P.Ky,polygonOffset:t,depthTest:C.sf,depthWrite:null,colorWrite:P.kn,stencilWrite:null,stencilTest:C.mK,drawBuffers:e.output===f.V.Depth?{buffers:[x.Hr.NONE]}:null}),this._occluderPipelineOpaque=(0,P.Ey)({blending:P.Ky,polygonOffset:t,depthTest:C.sf,depthWrite:null,colorWrite:P.kn,stencilWrite:C.r8,stencilTest:C.I$,drawBuffers:e.output===f.V.Depth?{buffers:[x.Hr.NONE]}:null}),this._occluderPipelineMaskWrite=(0,P.Ey)({blending:null,polygonOffset:t,depthTest:C.m,depthWrite:null,colorWrite:null,stencilWrite:C.v0,stencilTest:C.a9,drawBuffers:e.output===f.V.Depth?{buffers:[x.Hr.NONE]}:null})}return this._occludeePipeline=this._makePipelineState(e,!0),this._makePipelineState(e,!1)}getPipeline(e,t){if(e)return this._occludeePipeline;switch(t){case _.N.TRANSPARENT_OCCLUDER_MATERIAL:return this._occluderPipelineTransparent??super.getPipeline();case _.N.OCCLUDER_MATERIAL:return this._occluderPipelineOpaque??super.getPipeline();default:return this._occluderPipelineMaskWrite??super.getPipeline()}}}const k={factor:0,units:-4},L=new Map([[E.r.POSITION,0],[E.r.PREVPOSITION,1],[E.r.NEXTPOSITION,2],[E.r.SUBDIVISIONFACTOR,3],[E.r.UV0,4],[E.r.COLOR,5],[E.r.COLORFEATUREATTRIBUTE,5],[E.r.SIZE,6],[E.r.SIZEFEATUREATTRIBUTE,6],[E.r.OPACITYFEATUREATTRIBUTE,7],[E.r.OBJECTANDLAYERIDCOLOR,8]]);var I,N,M=r(47268);(N=I||(I={}))[N.LEFT_JOIN_START=-2]="LEFT_JOIN_START",N[N.LEFT_JOIN_END=-1]="LEFT_JOIN_END",N[N.LEFT_CAP_START=-4]="LEFT_CAP_START",N[N.LEFT_CAP_END=-5]="LEFT_CAP_END",N[N.RIGHT_JOIN_START=2]="RIGHT_JOIN_START",N[N.RIGHT_JOIN_END=1]="RIGHT_JOIN_END",N[N.RIGHT_CAP_START=4]="RIGHT_CAP_START",N[N.RIGHT_CAP_END=5]="RIGHT_CAP_END";class j extends y.im{constructor(e){super(e,z),this._configuration=new M.Q,this.vertexAttributeLocations=L,this.produces=new Map([[_.N.OPAQUE_MATERIAL,e=>(0,f.CL)(e)||(0,f._o)(e)&&this.parameters.renderOccluded===y.m$.OccludeAndTransparentStencil],[_.N.OPAQUE_MATERIAL_WITHOUT_NORMALS,e=>(0,f.eh)(e)],[_.N.OCCLUDER_MATERIAL,e=>(0,f.MO)(e)&&this.parameters.renderOccluded===y.m$.OccludeAndTransparentStencil],[_.N.TRANSPARENT_OCCLUDER_MATERIAL,e=>(0,f.MO)(e)&&this.parameters.renderOccluded===y.m$.OccludeAndTransparentStencil],[_.N.TRANSPARENT_MATERIAL,e=>e===f.V.Color&&this.parameters.writeDepth&&this.parameters.renderOccluded!==y.m$.OccludeAndTransparentStencil],[_.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>e===f.V.Color&&!this.parameters.writeDepth&&this.parameters.renderOccluded!==y.m$.OccludeAndTransparentStencil],[_.N.DRAPED_MATERIAL,e=>(0,f.i3)(e)]])}getConfiguration(e,t){this._configuration.output=e,this._configuration.oitPass=t.oitPass,this._configuration.draped=t.slot===_.N.DRAPED_MATERIAL;const r=null!=this.parameters.stipplePattern&&e!==f.V.Highlight;return this._configuration.stippleEnabled=r,this._configuration.stippleOffColorEnabled=r&&null!=this.parameters.stippleOffColor,this._configuration.stipplePreferContinuous=r&&this.parameters.stipplePreferContinuous,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.roundJoins="round"===this.parameters.join,this._configuration.capType=this.parameters.cap,this._configuration.applyMarkerOffset=null!=this.parameters.markerParameters&&function(e){return e.anchor===S.kJ.Tip&&e.hideOnShortSegments&&"begin-end"===e.placement&&e.worldSpace}(this.parameters.markerParameters),this._configuration.hasPolygonOffset=this.parameters.hasPolygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvSize=!!this.parameters.vvSize,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.vvOpacity=!!this.parameters.vvOpacity,this._configuration.innerColorEnabled=this.parameters.innerWidth>0&&null!=this.parameters.innerColor,this._configuration.falloffEnabled=this.parameters.falloff>0,this._configuration.hasOccludees=t.hasOccludees,this._configuration.occluder=this.parameters.renderOccluded===y.m$.OccludeAndTransparentStencil,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.wireframe=this.parameters.wireframe,this._configuration}get visible(){return this.parameters.color[3]>=m.Q||null!=this.parameters.stipplePattern&&(this.parameters.stippleOffColor?.[3]??0)>m.Q}intersectDraped({attributes:e,screenToWorldRatio:t},r,n,i,a,s){if(!n.options.selectionMode)return;const l=e.get(E.r.SIZE);let c=this.parameters.width;if(this.parameters.vvSize){const t=e.get(E.r.SIZEFEATUREATTRIBUTE).data[0];c*=(0,o.qE)(this.parameters.vvSize.offset[0]+t*this.parameters.vvSize.factor[0],this.parameters.vvSize.minSize[0],this.parameters.vvSize.maxSize[0])}else l&&(c*=l.data[0]);const d=i[0],u=i[1],p=(c/2+4)*t;let h=Number.MAX_VALUE,f=0;const m=e.get(E.r.POSITION).data,v=$(this.parameters,e)?m.length-2:m.length-5;for(let e=0;e<v;e+=3){const t=m[e],r=m[e+1],n=(e+3)%m.length,i=d-t,a=u-r,s=m[n]-t,l=m[n+1]-r,c=(0,o.qE)((s*i+l*a)/(s*s+l*l),0,1),p=s*c-i,v=l*c-a,g=p*p+v*v;g<h&&(h=g,f=e/3)}h<p*p&&a(s.dist,s.normal,f,!1)}intersect(e,t,r,i,l,c){if(!r.options.selectionMode||!e.visible)return;if(!(0,w.zH)(t))return void n.A.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial").error("intersection assumes a translation-only matrix");const h=e.attributes,f=h.get(E.r.POSITION).data;let m=this.parameters.width;if(this.parameters.vvSize){const e=h.get(E.r.SIZEFEATUREATTRIBUTE).data[0];m*=(0,o.qE)(this.parameters.vvSize.offset[0]+e*this.parameters.vvSize.factor[0],this.parameters.vvSize.minSize[0],this.parameters.vvSize.maxSize[0])}else h.has(E.r.SIZE)&&(m*=h.get(E.r.SIZE).data[0]);const v=r.camera,g=Y;(0,a.C)(g,r.point);const y=m*v.pixelRatio/2+4*v.pixelRatio;(0,s.i)(oe[0],g[0]-y,g[1]+y,0),(0,s.i)(oe[1],g[0]+y,g[1]+y,0),(0,s.i)(oe[2],g[0]+y,g[1]-y,0),(0,s.i)(oe[3],g[0]-y,g[1]-y,0);for(let e=0;e<4;e++)if(!v.unprojectFromRenderScreen(oe[e],ie[e]))return;(0,p.Cr)(v.eye,ie[0],ie[1],ae),(0,p.Cr)(v.eye,ie[1],ie[2],se),(0,p.Cr)(v.eye,ie[2],ie[3],le),(0,p.Cr)(v.eye,ie[3],ie[0],ce);let _=Number.MAX_VALUE,b=0;const S=$(this.parameters,h)?f.length-2:f.length-5;for(let e=0;e<S;e+=3){B[0]=f[e]+t[12],B[1]=f[e+1]+t[13],B[2]=f[e+2]+t[14];const r=(e+3)%f.length;if(V[0]=f[r]+t[12],V[1]=f[r+1]+t[13],V[2]=f[r+2]+t[14],(0,p.mN)(ae,B)<0&&(0,p.mN)(ae,V)<0||(0,p.mN)(se,B)<0&&(0,p.mN)(se,V)<0||(0,p.mN)(le,B)<0&&(0,p.mN)(le,V)<0||(0,p.mN)(ce,B)<0&&(0,p.mN)(ce,V)<0)continue;if(v.projectToRenderScreen(B,q),v.projectToRenderScreen(V,X),q[2]<0&&X[2]>0){(0,s.d)(G,B,V);const e=v.frustum,t=-(0,p.mN)(e[d.FB.NEAR],B)/(0,s.f)(G,(0,p.Qj)(e[d.FB.NEAR]));(0,s.h)(G,G,t),(0,s.g)(B,B,G),v.projectToRenderScreen(B,q)}else if(q[2]>0&&X[2]<0){(0,s.d)(G,V,B);const e=v.frustum,t=-(0,p.mN)(e[d.FB.NEAR],V)/(0,s.f)(G,(0,p.Qj)(e[d.FB.NEAR]));(0,s.h)(G,G,t),(0,s.g)(V,V,G),v.projectToRenderScreen(V,X)}else if(q[2]<0&&X[2]<0)continue;q[2]=0,X[2]=0;const n=(0,u.kb)((0,u.Cr)(q,X,K),g);n<_&&(_=n,(0,s.c)(Z,B),(0,s.c)(Q,V),b=e/3)}const T=r.rayBegin,A=r.rayEnd;if(_<y*y){let e=Number.MAX_VALUE;if((0,u.ld)((0,u.Cr)(Z,Q,K),(0,u.Cr)(T,A,ee),J)){(0,s.d)(J,J,T);const t=(0,s.l)(J);(0,s.h)(J,J,1/t),e=t/(0,s.j)(T,A)}c(e,J,b,!1)}}get _layout(){const e=(0,h.BP)().vec3f(E.r.POSITION).vec3f(E.r.PREVPOSITION).vec3f(E.r.NEXTPOSITION).f32(E.r.SUBDIVISIONFACTOR).vec2f(E.r.UV0);return this.parameters.vvSize?e.f32(E.r.SIZEFEATUREATTRIBUTE):e.f32(E.r.SIZE),this.parameters.vvColor?e.f32(E.r.COLORFEATUREATTRIBUTE):e.vec4f(E.r.COLOR),this.parameters.vvOpacity&&e.f32(E.r.OPACITYFEATUREATTRIBUTE),(0,v.E)()&&e.vec4u8(E.r.OBJECTANDLAYERIDCOLOR),e}createBufferWriter(){return new U(this._layout,this.parameters)}createGLMaterial(e){return new W(e)}validateParameters(e){"miter"!==e.join&&(e.miterLimit=0),null!=e.markerParameters&&(e.markerScale=e.markerParameters.width/e.width)}}class W extends g.A{constructor(){super(...arguments),this._stipplePattern=null}dispose(){super.dispose(),this._stippleTextures.release(this._stipplePattern),this._stipplePattern=null}beginSlot(e){const t=this._material.parameters.stipplePattern;return this._stipplePattern!==t&&(this._material.setParameters({stippleTexture:this._stippleTextures.swap(t,this._stipplePattern)}),this._stipplePattern=t),this.acquireTechnique(F,e)}}class z extends b.S{constructor(){super(...arguments),this.width=0,this.color=c.Un,this.join="miter",this.cap=M.x.BUTT,this.miterLimit=5,this.writeDepth=!0,this.hasPolygonOffset=!1,this.stippleTexture=null,this.stipplePreferContinuous=!0,this.markerParameters=null,this.markerScale=1,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.isClosed=!1,this.falloff=0,this.innerWidth=0,this.wireframe=!1}get transparent(){return this.color[3]<1||null!=this.stipplePattern&&(this.stippleOffColor?.[3]??0)<1}}class U{constructor(e,t){this.vertexBufferLayout=e,this._parameters=t,this.numJoinSubdivisions=0;const r=t.stipplePattern?1:0;switch(this._parameters.join){case"miter":case"bevel":this.numJoinSubdivisions=r;break;case"round":this.numJoinSubdivisions=T.r+r}}_isClosed(e){return $(this._parameters,e)}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){const t=e.get(E.r.POSITION).indices.length/2+1,r=this._isClosed(e);let n=r?2:4;return n+=((r?t:t-1)-(r?0:1))*(2*this.numJoinSubdivisions+4),n+=2,this._parameters.wireframe&&(n=2+4*(n-2)),n}write(e,t,r,n,o,i){const a=te,l=re,c=ne,d=r.get(E.r.POSITION),u=d.indices,p=d.data.length/3,h=r.get(E.r.DISTANCETOSTART)?.data;u&&u.length!==2*(p-1)&&console.warn("RibbonLineMaterial does not support indices");const f=r.get(E.r.SIZEFEATUREATTRIBUTE)?.data[0]??r.get(E.r.SIZE)?.data[0]??1;let m=[1,1,1,1],g=0;const y=this.vertexBufferLayout.fields.has(E.r.COLORFEATUREATTRIBUTE);y?g=r.get(E.r.COLORFEATUREATTRIBUTE).data[0]:r.has(E.r.COLOR)&&(m=r.get(E.r.COLOR).data);const _=this.vertexBufferLayout.fields.has(E.r.OPACITYFEATUREATTRIBUTE),w=_?r.get(E.r.OPACITYFEATUREATTRIBUTE).data[0]:0,b=new Float32Array(o.buffer),S=(0,v.E)()?new Uint8Array(o.buffer):null,T=this.vertexBufferLayout.stride/4;let A=i*T;const O=A;let D=0;const R=h?(e,t,r)=>D=h[r]:(e,t,r)=>D+=(0,s.j)(e,t),C=(e,t,r,o,i,a,s)=>{if(b[A++]=t[0],b[A++]=t[1],b[A++]=t[2],b[A++]=e[0],b[A++]=e[1],b[A++]=e[2],b[A++]=r[0],b[A++]=r[1],b[A++]=r[2],b[A++]=o,b[A++]=s,b[A++]=i,b[A++]=f,y)b[A++]=g;else{const e=Math.min(4*a,m.length-4);b[A++]=m[e],b[A++]=m[e+1],b[A++]=m[e+2],b[A++]=m[e+3]}_&&(b[A++]=w),(0,v.E)()&&(n&&(S[4*A]=n[0],S[4*A+1]=n[1],S[4*A+2]=n[2],S[4*A+3]=n[3]),A++)};A+=T,(0,s.i)(l,d.data[0],d.data[1],d.data[2]),e&&(0,s.t)(l,l,e);const x=this._isClosed(r);if(x){const t=d.data.length-3;(0,s.i)(a,d.data[t],d.data[t+1],d.data[t+2]),e&&(0,s.t)(a,a,e)}else(0,s.i)(c,d.data[3],d.data[4],d.data[5]),e&&(0,s.t)(c,c,e),C(l,l,c,1,I.LEFT_CAP_START,0,0),C(l,l,c,1,I.RIGHT_CAP_START,0,0),(0,s.c)(a,l),(0,s.c)(l,c);const P=x?0:1,F=x?p:p-1;for(let t=P;t<F;t++){const r=(t+1)%p*3;(0,s.i)(c,d.data[r],d.data[r+1],d.data[r+2]),e&&(0,s.t)(c,c,e),R(a,l,t),C(a,l,c,0,I.LEFT_JOIN_END,t,D),C(a,l,c,0,I.RIGHT_JOIN_END,t,D);const n=this.numJoinSubdivisions;for(let e=0;e<n;++e){const r=(e+1)/(n+1);C(a,l,c,r,I.LEFT_JOIN_END,t,D),C(a,l,c,r,I.RIGHT_JOIN_END,t,D)}C(a,l,c,1,I.LEFT_JOIN_START,t,D),C(a,l,c,1,I.RIGHT_JOIN_START,t,D),(0,s.c)(a,l),(0,s.c)(l,c)}x?((0,s.i)(c,d.data[3],d.data[4],d.data[5]),e&&(0,s.t)(c,c,e),D=R(a,l,F),C(a,l,c,0,I.LEFT_JOIN_END,P,D),C(a,l,c,0,I.RIGHT_JOIN_END,P,D)):(D=R(a,l,F),C(a,l,l,0,I.LEFT_CAP_END,F,D),C(a,l,l,0,I.RIGHT_CAP_END,F,D)),H(b,O+T,b,O,T),A=H(b,A-T,b,A,T),this._parameters.wireframe&&this._addWireframeVertices(o,O,A,T)}_addWireframeVertices(e,t,r,n){const o=new Float32Array(e.buffer,r*Float32Array.BYTES_PER_ELEMENT),i=new Float32Array(e.buffer,t*Float32Array.BYTES_PER_ELEMENT,r-t);let a=0;const s=e=>a=H(i,e,o,a,n);for(let e=0;e<i.length-1;e+=2*n)s(e),s(e+2*n),s(e+1*n),s(e+2*n),s(e+1*n),s(e+3*n)}}function H(e,t,r,n,o){for(let i=0;i<o;i++)r[n++]=e[t++];return n}function $(e,t){return!!e.isClosed&&t.get(E.r.POSITION).indices.length>2}const B=(0,l.vt)(),V=(0,l.vt)(),G=(0,l.vt)(),J=(0,l.vt)(),Y=(0,l.vt)(),q=(0,i.r_)(),X=(0,i.r_)(),Z=(0,l.vt)(),Q=(0,l.vt)(),K=(0,u.vt)(),ee=(0,u.vt)(),te=(0,l.vt)(),re=(0,l.vt)(),ne=(0,l.vt)(),oe=[(0,i.r_)(),(0,i.r_)(),(0,i.r_)(),(0,i.r_)()],ie=[(0,l.vt)(),(0,l.vt)(),(0,l.vt)(),(0,l.vt)()],ae=(0,p.vt)(),se=(0,p.vt)(),le=(0,p.vt)(),ce=(0,p.vt)()},18994:(e,t,r)=>{r.d(t,{Dt:()=>u,kJ:()=>o,lM:()=>n});var n,o,i,a=r(82392),s=r(51229),l=r(6750),c=r(67069),d=r(12013);(i=n||(n={}))[i.Draped=0]="Draped",i[i.Screen=1]="Screen",i[i.World=2]="World",i[i.COUNT=3]="COUNT",function(e){e[e.Center=0]="Center",e[e.Tip=1]="Tip",e[e.COUNT=2]="COUNT"}(o||(o={}));class u extends d.E{constructor(){super(...arguments),this.space=n.Screen,this.anchor=o.Center,this.occluder=!1,this.hasSlicePlane=!1,this.writeDepth=!1,this.hideOnShortSegments=!1,this.hasCap=!1,this.hasTip=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.textureCoordinateType=s.I.None,this.emissionSource=l.ZX.None,this.discardInvisibleFragments=!0,this.occlusionPass=!1,this.hasVvInstancing=!0,this.hasSliceTranslatedView=!0,this.objectAndLayerIdColorInstanced=!1}get draped(){return this.space===n.Draped}}(0,a._)([(0,c.W)({count:n.COUNT})],u.prototype,"space",void 0),(0,a._)([(0,c.W)({count:o.COUNT})],u.prototype,"anchor",void 0),(0,a._)([(0,c.W)()],u.prototype,"occluder",void 0),(0,a._)([(0,c.W)()],u.prototype,"hasSlicePlane",void 0),(0,a._)([(0,c.W)()],u.prototype,"writeDepth",void 0),(0,a._)([(0,c.W)()],u.prototype,"hideOnShortSegments",void 0),(0,a._)([(0,c.W)()],u.prototype,"hasCap",void 0),(0,a._)([(0,c.W)()],u.prototype,"hasTip",void 0),(0,a._)([(0,c.W)()],u.prototype,"vvSize",void 0),(0,a._)([(0,c.W)()],u.prototype,"vvColor",void 0),(0,a._)([(0,c.W)()],u.prototype,"vvOpacity",void 0),(0,a._)([(0,c.W)()],u.prototype,"hasOccludees",void 0),(0,a._)([(0,c.W)()],u.prototype,"terrainDepthTest",void 0),(0,a._)([(0,c.W)()],u.prototype,"cullAboveTerrain",void 0)},34402:(e,t,r)=>{var n;r.d(t,{q:()=>n}),function(e){e[e.ASYNC=0]="ASYNC",e[e.SYNC=1]="SYNC"}(n||(n={}))},35542:(e,t,r)=>{r.d(t,{KF:()=>f,MF:()=>h,VG:()=>d,g7:()=>p,gf:()=>u,o8:()=>l,q6:()=>c});var n=r(80861),o=r(37623),i=r(96124),a=r(83911);const s=()=>n.A.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");function l(e){return{cachedResult:e.cachedResult,arcade:e.arcade?{func:e.arcade.func,context:e.arcade.modules.arcadeUtils.createExecContext(null,{sr:e.arcade.context.spatialReference}),modules:e.arcade.modules}:null}}async function c(e,t,r,n){const i=e?.expression;if("string"!=typeof i)return null;const s=function(e){return"0"===e?0:null}(i);if(null!=s)return{cachedResult:s};const l=await(0,a.lw)();(0,o.Te)(r);const c=l.arcadeUtils,d=c.createSyntaxTree(i);return c.dependsOnView(d)?(null!=n&&n.error("Expressions containing '$view' are not supported on ElevationInfo"),{cachedResult:0}):{arcade:{func:c.createFunction(d),context:c.createExecContext(null,{sr:t}),modules:l}}}function d(e,t,r){return e.arcadeUtils.createFeature(t.attributes,t.geometry,r)}function u(e,t){if(null!=e&&!m(e)){if(!t||!e.arcade)return void s().errorOncePerTick("Arcade support required but not provided");const r=t;r._geometry&&(r._geometry=(0,i.wZ)(r._geometry)),e.arcade.modules.arcadeUtils.updateExecContext(e.arcade.context,t)}}function p(e){if(null!=e){if(m(e))return e.cachedResult;const t=e.arcade;let r=t?.modules.arcadeUtils.executeFunction(t.func,t.context);return"number"!=typeof r&&(e.cachedResult=0,r=0),r}return 0}function h(e,t=!1){let r=e?.featureExpressionInfo;const n=r?.expression;return t||"0"===n||(r=null),r??null}const f={cachedResult:0};function m(e){return null!=e.cachedResult}},37303:(e,t,r)=>{r.d(t,{s:()=>d});var n=r(24578),o=r(64802),i=r(19635),a=r(4930),s=r(41014),l=r(33763);const c=8;function d(e,t){const r=e.vertex;r.uniforms.add(new i.m("intrinsicWidth",(e=>e.width))),t.vvSize?(e.attributes.add(l.r.SIZEFEATUREATTRIBUTE,"float"),r.uniforms.add(new o.t("vvSizeMinSize",(e=>e.vvSize.minSize)),new o.t("vvSizeMaxSize",(e=>e.vvSize.maxSize)),new o.t("vvSizeOffset",(e=>e.vvSize.offset)),new o.t("vvSizeFactor",(e=>e.vvSize.factor))),r.code.add(s.H`float getSize() {
return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;
}`)):(e.attributes.add(l.r.SIZE,"float"),r.code.add(s.H`float getSize(){
return intrinsicWidth * size;
}`)),t.vvOpacity?(e.attributes.add(l.r.OPACITYFEATUREATTRIBUTE,"float"),r.constants.add("vvOpacityNumber","int",8),r.uniforms.add(new a.x("vvOpacityValues",(e=>e.vvOpacity.values),c),new a.x("vvOpacityOpacities",(e=>e.vvOpacity.opacityValues),c)),r.code.add(s.H`float interpolateOpacity( float value ){
if (value <= vvOpacityValues[0]) {
return vvOpacityOpacities[0];
}
for (int i = 1; i < vvOpacityNumber; ++i) {
if (vvOpacityValues[i] >= value) {
float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);
return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);
}
}
return vvOpacityOpacities[vvOpacityNumber - 1];
}
vec4 applyOpacity( vec4 color ){
return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));
}`)):r.code.add(s.H`vec4 applyOpacity( vec4 color ){
return color;
}`),t.vvColor?(e.include(n.A,t),e.attributes.add(l.r.COLORFEATUREATTRIBUTE,"float"),r.code.add(s.H`vec4 getColor(){
return applyOpacity(interpolateVVColor(colorFeatureAttribute));
}`)):(e.attributes.add(l.r.COLOR,"vec4"),r.code.add(s.H`vec4 getColor(){
return applyOpacity(color);
}`))}},45072:(e,t,r)=>{r.d(t,{g:()=>g}),r(6273);var n=r(78851),o=r(80347),i=r(19913),a=r(76982),s=r(88133),l=r(10941),c=r(61723),d=r(16869),u=r(96024),p=r(54909),h=r(58304),f=r(33763),m=r(5415),v=r(16596);class g{constructor(e){this._originSR=e,this._rootOriginId="root/"+(0,n.c)(),this._origins=new Map,this._objects=new Map,this._gridSize=5e5}getOrigin(e){const t=this._origins.get(this._rootOriginId);if(null==t){const t=h.Q.rootOrigin;if(null!=t)return this._origins.set(this._rootOriginId,(0,u.f)(t[0],t[1],t[2],this._rootOriginId)),this.getOrigin(e);const r=(0,u.f)(e[0]+Math.random()-.5,e[1]+Math.random()-.5,e[2]+Math.random()-.5,this._rootOriginId);return this._origins.set(this._rootOriginId,r),r}const r=this._gridSize,n=Math.round(e[0]/r),i=Math.round(e[1]/r),a=Math.round(e[2]/r),s=`${n}/${i}/${a}`;let l=this._origins.get(s);const c=.5*r;if((0,o.d)(y,e,t.vec3),y[0]=Math.abs(y[0]),y[1]=Math.abs(y[1]),y[2]=Math.abs(y[2]),y[0]<c&&y[1]<c&&y[2]<c){if(l){const t=Math.max(...y);if((0,o.d)(y,e,l.vec3),y[0]=Math.abs(y[0]),y[1]=Math.abs(y[1]),y[2]=Math.abs(y[2]),Math.max(...y)<t)return l}return t}return l||(l=(0,u.f)(n*r,i*r,a*r,s),this._origins.set(s,l)),l}_drawOriginBox(e,t=(0,a.fA)(1,1,0,1)){const r=window.view,n=r._stage,o=t.toString();if(!this._objects.has(o)){this._material=new v.W({width:2,color:t}),n.add(this._material);const e=new m.x(n,{pickable:!1}),r=new p.B({castShadow:!1});n.add(r),e.add(r),this._objects.set(o,r)}const i=this._objects.get(o),u=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],h=u.length,g=new Array(3*h),y=new Array,_=.5*this._gridSize;for(let t=0;t<h;t++)g[3*t]=e[0]+(1&u[t]?_:-_),g[3*t+1]=e[1]+(2&u[t]?_:-_),g[3*t+2]=e[2]+(4&u[t]?_:-_),t>0&&y.push(t-1,t);(0,s.projectBuffer)(g,this._originSR,0,g,r.renderSpatialReference,0,h);const w=new d.V(this._material,[[f.r.POSITION,new l.n(g,y,3,!0)]],null,c.X.Line);n.add(w),i.addGeometry(w)}get test(){}}const y=(0,i.vt)()},46348:(e,t,r)=>{r.d(t,{R:()=>O,b:()=>A,r:()=>T});var n=r(77788),o=r(29592),i=r(38587),a=r(37303),s=r(77802),l=r(47913),c=r(48425),d=r(85807),u=r(78546),p=r(83660),h=r(69952),f=r(66579),m=r(92121),v=r(19635),g=r(41014),y=r(99040),_=r(92624),w=r(33763),E=r(18994),b=r(288),S=r(47268);const T=1;function A(e){const t=new _.N5,{attributes:r,varyings:A,vertex:O,fragment:D}=t,{applyMarkerOffset:R,draped:C,output:x,capType:P,stippleEnabled:F,falloffEnabled:k,roundJoins:L,wireframe:I,innerColorEnabled:N}=e;t.include(c.p),t.include(a.s,e),t.include(s.q,e),t.include(i.g,e);const M=R&&!C;M&&(O.uniforms.add(new v.m("markerScale",(e=>e.markerScale))),t.include(l.r,{space:E.lM.World})),(0,h.NB)(O,e),O.uniforms.add(new y.X("inverseProjectionMatrix",((e,t)=>t.camera.inverseProjectionMatrix)),new f.G("nearFar",((e,t)=>t.camera.nearFar)),new v.m("miterLimit",(e=>"miter"!==e.join?0:e.miterLimit)),new m.E("viewport",((e,t)=>t.camera.fullViewport))),O.constants.add("LARGE_HALF_FLOAT","float",65500),r.add(w.r.POSITION,"vec3"),r.add(w.r.PREVPOSITION,"vec3"),r.add(w.r.NEXTPOSITION,"vec3"),r.add(w.r.SUBDIVISIONFACTOR,"float"),r.add(w.r.UV0,"vec2"),A.add("vColor","vec4"),A.add("vpos","vec3"),A.add("vLineDistance","float"),A.add("vLineWidth","float");const j=e.terrainDepthTest&&x===n.V.Color;j&&A.add("depth","float");const W=F;W&&A.add("vLineSizeInv","float");const z=P===S.x.ROUND,U=F&&z,H=k||U;H&&A.add("vLineDistanceNorm","float"),z&&(A.add("vSegmentSDF","float"),A.add("vReverseSegmentSDF","float")),O.code.add(g.H`#define PERPENDICULAR(v) vec2(v.y, -v.x);
float interp(float ncp, vec4 a, vec4 b) {
return (-ncp - a.z) / (b.z - a.z);
}
vec2 rotate(vec2 v, float a) {
float s = sin(a);
float c = cos(a);
mat2 m = mat2(c, -s, s, c);
return m * v;
}`),O.code.add(g.H`vec4 projectAndScale(vec4 pos) {
vec4 posNdc = proj * pos;
posNdc.xy *= viewport.zw / posNdc.w;
return posNdc;
}`),O.code.add(g.H`
    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {
      float vnp = nearFar[0] * 0.99;

      if(pos.z > -nearFar[0]) {
        //current pos behind ncp --> we need to clip
        if (!isStartVertex) {
          if(prev.z < -nearFar[0]) {
            //previous in front of ncp
            pos = mix(prev, pos, interp(vnp, prev, pos));
            next = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        } else {
          if(next.z < -nearFar[0]) {
            //next in front of ncp
            pos = mix(pos, next, interp(vnp, pos, next));
            prev = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        }
      } else {
        //current position visible
        if (prev.z > -nearFar[0]) {
          //previous behind ncp
          prev = mix(pos, prev, interp(vnp, pos, prev));
        }
        if (next.z > -nearFar[0]) {
          //next behind ncp
          next = mix(next, pos, interp(vnp, next, pos));
        }
      }

      ${j?"depth = pos.z;":""}

      pos = projectAndScale(pos);
      next = projectAndScale(next);
      prev = projectAndScale(prev);
    }
  `),(0,h.Nz)(O),O.constants.add("aaWidth","float",F?0:1).main.add(g.H`
    // unpack values from uv0.y
    bool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;

    float coverage = 1.0;

    // Check for special value of uv0.y which is used by the Renderer when graphics
    // are removed before the VBO is recompacted. If this is the case, then we just
    // project outside of clip space.
    if (uv0.y == 0.0) {
      // Project out of clip space
      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
    }
    else {
      bool isJoin = abs(uv0.y) < 3.0;
      float lineSize = getSize();

      if (lineSize < 1.0) {
        coverage = lineSize; // convert sub-pixel coverage to alpha
        lineSize = 1.0;
      }
      lineSize += aaWidth;

      float lineWidth = lineSize * pixelRatio;
      vLineWidth = lineWidth;
      ${W?g.H`vLineSizeInv = 1.0 / lineSize;`:""}

      vec4 pos  = view * vec4(position, 1.0);
      vec4 prev = view * vec4(prevPosition, 1.0);
      vec4 next = view * vec4(nextPosition, 1.0);
  `),M&&O.main.add(g.H`vec4 other = isStartVertex ? next : prev;
bool markersHidden = areWorldMarkersHidden(pos, other);
if(!isJoin && !markersHidden) {
pos.xyz += normalize(other.xyz - pos.xyz) * getWorldMarkerSize(pos) * 0.5;
}`),O.main.add(g.H`clipAndTransform(pos, prev, next, isStartVertex);
vec2 left = (pos.xy - prev.xy);
vec2 right = (next.xy - pos.xy);
float leftLen = length(left);
float rightLen = length(right);`),(F||z)&&O.main.add(g.H`
      float isEndVertex = float(!isStartVertex);
      vec2 segmentOrigin = mix(pos.xy, prev.xy, isEndVertex);
      vec2 segment = mix(right, left, isEndVertex);
      ${z?g.H`vec2 segmentEnd = mix(next.xy, pos.xy, isEndVertex);`:""}
    `),O.main.add(g.H`left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);
right = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);
vec2 capDisplacementDir = vec2(0, 0);
vec2 joinDisplacementDir = vec2(0, 0);
float displacementLen = lineWidth;
if (isJoin) {
bool isOutside = (left.x * right.y - left.y * right.x) * uv0.y > 0.0;
joinDisplacementDir = normalize(left + right);
joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);
if (leftLen > 0.001 && rightLen > 0.001) {
float nDotSeg = dot(joinDisplacementDir, left);
displacementLen /= length(nDotSeg * left - joinDisplacementDir);
if (!isOutside) {
displacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));
}
}
if (isOutside && (displacementLen > miterLimit * lineWidth)) {`),L?O.main.add(g.H`
        vec2 startDir = leftLen < 0.001 ? right : left;
        startDir = PERPENDICULAR(startDir);

        vec2 endDir = rightLen < 0.001 ? left : right;
        endDir = PERPENDICULAR(endDir);

        float factor = ${F?g.H`min(1.0, subdivisionFactor * ${g.H.float((T+2)/(T+1))})`:g.H`subdivisionFactor`};

        float rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));
        joinDisplacementDir = rotate(startDir, -sign(uv0.y) * factor * rotationAngle);
      `):O.main.add(g.H`if (leftLen < 0.001) {
joinDisplacementDir = right;
}
else if (rightLen < 0.001) {
joinDisplacementDir = left;
}
else {
joinDisplacementDir = (isStartVertex || subdivisionFactor > 0.0) ? right : left;
}
joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);`);const $=P!==S.x.BUTT;return O.main.add(g.H`
        displacementLen = lineWidth;
      }
    } else {
      // CAP handling ---------------------------------------------------
      joinDisplacementDir = isStartVertex ? right : left;
      joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);

      ${$?g.H`capDisplacementDir = isStartVertex ? -right : left;`:""}
    }
  `),O.main.add(g.H`
    // Displacement (in pixels) caused by join/or cap
    vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;
    float lineDistNorm = sign(uv0.y) * pos.w;

    vLineDistance =  lineWidth * lineDistNorm;
    ${H?g.H`vLineDistanceNorm = lineDistNorm;`:""}

    pos.xy += dpos;
  `),z&&O.main.add(g.H`vec2 segmentDir = normalize(segment);
vSegmentSDF = (isJoin && isStartVertex) ? LARGE_HALF_FLOAT : (dot(pos.xy - segmentOrigin, segmentDir) * pos.w) ;
vReverseSegmentSDF = (isJoin && !isStartVertex) ? LARGE_HALF_FLOAT : (dot(pos.xy - segmentEnd, -segmentDir) * pos.w);`),F&&(C?O.uniforms.add(new v.m("worldToScreenRatio",((e,t)=>1/t.screenToPCSRatio))):O.main.add(g.H`vec3 segmentCenter = mix((nextPosition + position) * 0.5, (position + prevPosition) * 0.5, isEndVertex);
float worldToScreenRatio = computeWorldToScreenRatio(segmentCenter);`),O.main.add(g.H`float segmentLengthScreenDouble = length(segment);
float segmentLengthScreen = segmentLengthScreenDouble * 0.5;
float discreteWorldToScreenRatio = discretizeWorldToScreenRatio(worldToScreenRatio);
float segmentLengthRender = length(mix(nextPosition - position, position - prevPosition, isEndVertex));
vStipplePatternStretch = worldToScreenRatio / discreteWorldToScreenRatio;`),C?O.main.add(g.H`float segmentLengthPseudoScreen = segmentLengthScreen / pixelRatio * discreteWorldToScreenRatio / worldToScreenRatio;
float startPseudoScreen = uv0.x * discreteWorldToScreenRatio - mix(0.0, segmentLengthPseudoScreen, isEndVertex);`):O.main.add(g.H`float startPseudoScreen = mix(uv0.x, uv0.x - segmentLengthRender, isEndVertex) * discreteWorldToScreenRatio;
float segmentLengthPseudoScreen = segmentLengthRender * discreteWorldToScreenRatio;`),O.uniforms.add(new v.m("stipplePatternPixelSize",(e=>(0,s.h)(e)))),O.main.add(g.H`float patternLength = lineSize * stipplePatternPixelSize;
vStippleDistanceLimits = computeStippleDistanceLimits(startPseudoScreen, segmentLengthPseudoScreen, segmentLengthScreen, patternLength);
vStippleDistance = mix(vStippleDistanceLimits.x, vStippleDistanceLimits.y, isEndVertex);
if (segmentLengthScreenDouble >= 0.001) {
vec2 stippleDisplacement = pos.xy - segmentOrigin;
float stippleDisplacementFactor = dot(segment, stippleDisplacement) / (segmentLengthScreenDouble * segmentLengthScreenDouble);
vStippleDistance += (stippleDisplacementFactor - isEndVertex) * (vStippleDistanceLimits.y - vStippleDistanceLimits.x);
}
vStippleDistanceLimits *= pos.w;
vStippleDistance *= pos.w;
vStippleDistanceLimits = isJoin ?
vStippleDistanceLimits :
isStartVertex ?
vec2(-1e34, vStippleDistanceLimits.y) :
vec2(vStippleDistanceLimits.x, 1e34);`)),O.main.add(g.H`
      // Convert back into NDC
      pos.xy = (pos.xy / viewport.zw) * pos.w;

      vColor = getColor();
      vColor.a *= coverage;

      ${I&&!C?"pos.z -= 0.001 * pos.w;":""}

      // transform final position to camera space for slicing
      vpos = (inverseProjectionMatrix * pos).xyz;
      gl_Position = pos;
      forwardObjectAndLayerIdColor();
    }`),j&&t.include(d.Z,e),t.include(o.HQ,e),t.include(b.z,e),D.include(p.a),D.main.add(g.H`
    discardBySlice(vpos);
    ${j?"terrainDepthTest(depth);":""}
  `),I?D.main.add(g.H`vec4 finalColor = vec4(1.0, 0.0, 1.0, 1.0);`):(z&&D.main.add(g.H`
        float sdf = min(vSegmentSDF, vReverseSegmentSDF);
        vec2 fragmentPosition = vec2(
          min(sdf, 0.0),
          vLineDistance
        ) * gl_FragCoord.w;

        float fragmentRadius = length(fragmentPosition);
        float fragmentCapSDF = (fragmentRadius - vLineWidth) * 0.5; // Divide by 2 to transform from double pixel scale
        float capCoverage = clamp(0.5 - fragmentCapSDF, 0.0, 1.0);

        if (capCoverage < ${g.H.float(u.Q)}) {
          discard;
        }
      `),U?D.main.add(g.H`
      vec2 stipplePosition = vec2(
        min(getStippleSDF() * 2.0 - 1.0, 0.0),
        vLineDistanceNorm * gl_FragCoord.w
      );
      float stippleRadius = length(stipplePosition * vLineWidth);
      float stippleCapSDF = (stippleRadius - vLineWidth) * 0.5; // Divide by 2 to transform from double pixel scale
      float stippleCoverage = clamp(0.5 - stippleCapSDF, 0.0, 1.0);
      float stippleAlpha = step(${g.H.float(u.Q)}, stippleCoverage);
      `):D.main.add(g.H`float stippleAlpha = getStippleAlpha();`),x!==n.V.ObjectAndLayerIdColor&&D.main.add(g.H`discardByStippleAlpha(stippleAlpha, ${g.H.float(u.Q)});`),D.uniforms.add(new m.E("intrinsicColor",(e=>e.color))),D.main.add(g.H`vec4 color = intrinsicColor * vColor;`),N&&(D.uniforms.add(new m.E("innerColor",(e=>e.innerColor??e.color)),new v.m("innerWidth",((e,t)=>e.innerWidth*t.camera.pixelRatio))),D.main.add(g.H`float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;
float innerAA = clamp(0.5 - distToInner, 0.0, 1.0);
float innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);
color = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);`)),D.main.add(g.H`vec4 finalColor = blendStipple(color, stippleAlpha);`),k&&(D.uniforms.add(new v.m("falloff",(e=>e.falloff))),D.main.add(g.H`finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);`)),F||D.main.add(g.H`float featherStartDistance = max(vLineWidth - 2.0, 0.0);
float value = abs(vLineDistance) * gl_FragCoord.w;
float feather = (value - featherStartDistance) / (vLineWidth - featherStartDistance);
finalColor.a *= 1.0 - clamp(feather, 0.0, 1.0);`)),D.main.add(g.H`outputColorHighlightOID(finalColor, vpos);`),t}const O=Object.freeze(Object.defineProperty({__proto__:null,build:A,ribbonlineNumRoundJoinSubdivisions:T},Symbol.toStringTag,{value:"Module"}))},47268:(e,t,r)=>{r.d(t,{Q:()=>d,x:()=>n});var n,o,i=r(82392),a=r(51229),s=r(6750),l=r(67069),c=r(12013);(o=n||(n={}))[o.BUTT=0]="BUTT",o[o.SQUARE=1]="SQUARE",o[o.ROUND=2]="ROUND",o[o.COUNT=3]="COUNT";class d extends c.E{constructor(){super(...arguments),this.capType=n.BUTT,this.hasSlicePlane=!1,this.hasPolygonOffset=!1,this.writeDepth=!1,this.draped=!1,this.stippleEnabled=!1,this.stippleOffColorEnabled=!1,this.stipplePreferContinuous=!0,this.roundJoins=!1,this.applyMarkerOffset=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.falloffEnabled=!1,this.innerColorEnabled=!1,this.hasOccludees=!1,this.occluder=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.wireframe=!1,this.discardInvisibleFragments=!1,this.objectAndLayerIdColorInstanced=!1,this.textureCoordinateType=a.I.None,this.emissionSource=s.ZX.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.hasSliceTranslatedView=!0}}(0,i._)([(0,l.W)({count:n.COUNT})],d.prototype,"capType",void 0),(0,i._)([(0,l.W)()],d.prototype,"hasSlicePlane",void 0),(0,i._)([(0,l.W)()],d.prototype,"hasPolygonOffset",void 0),(0,i._)([(0,l.W)()],d.prototype,"writeDepth",void 0),(0,i._)([(0,l.W)()],d.prototype,"draped",void 0),(0,i._)([(0,l.W)()],d.prototype,"stippleEnabled",void 0),(0,i._)([(0,l.W)()],d.prototype,"stippleOffColorEnabled",void 0),(0,i._)([(0,l.W)()],d.prototype,"stipplePreferContinuous",void 0),(0,i._)([(0,l.W)()],d.prototype,"roundJoins",void 0),(0,i._)([(0,l.W)()],d.prototype,"applyMarkerOffset",void 0),(0,i._)([(0,l.W)()],d.prototype,"vvSize",void 0),(0,i._)([(0,l.W)()],d.prototype,"vvColor",void 0),(0,i._)([(0,l.W)()],d.prototype,"vvOpacity",void 0),(0,i._)([(0,l.W)()],d.prototype,"falloffEnabled",void 0),(0,i._)([(0,l.W)()],d.prototype,"innerColorEnabled",void 0),(0,i._)([(0,l.W)()],d.prototype,"hasOccludees",void 0),(0,i._)([(0,l.W)()],d.prototype,"occluder",void 0),(0,i._)([(0,l.W)()],d.prototype,"terrainDepthTest",void 0),(0,i._)([(0,l.W)()],d.prototype,"cullAboveTerrain",void 0),(0,i._)([(0,l.W)()],d.prototype,"wireframe",void 0),(0,i._)([(0,l.W)()],d.prototype,"discardInvisibleFragments",void 0),(0,i._)([(0,l.W)()],d.prototype,"objectAndLayerIdColorInstanced",void 0)},47913:(e,t,r)=>{r.d(t,{r:()=>l});var n=r(4498),o=r(69952),i=r(19635),a=r(41014),s=r(18994);function l(e,t){const r=e.vertex;(0,o.Nz)(r),null==r.uniforms.get("markerScale")&&r.constants.add("markerScale","float",1),r.constants.add("markerSizePerLineWidth","float",n.PV).code.add(a.H`float getLineWidth() {
return max(getSize(), 1.0) * pixelRatio;
}
float getScreenMarkerSize() {
return markerSizePerLineWidth * markerScale * getLineWidth();
}`),t.space===s.lM.World&&(r.constants.add("maxSegmentLengthFraction","float",.45),r.uniforms.add(new i.m("perRenderPixelRatio",((e,t)=>t.camera.perRenderPixelRatio))),r.code.add(a.H`bool areWorldMarkersHidden(vec4 pos, vec4 other) {
vec3 midPoint = mix(pos.xyz, other.xyz, 0.5);
float distanceToCamera = length(midPoint);
float screenToWorldRatio = perRenderPixelRatio * distanceToCamera * 0.5;
float worldMarkerSize = getScreenMarkerSize() * screenToWorldRatio;
float segmentLen = length(pos.xyz - other.xyz);
return worldMarkerSize > maxSegmentLengthFraction * segmentLen;
}
float getWorldMarkerSize(vec4 pos) {
float distanceToCamera = length(pos.xyz);
float screenToWorldRatio = perRenderPixelRatio * distanceToCamera * 0.5;
return getScreenMarkerSize() * screenToWorldRatio;
}`))}},54909:(e,t,r)=>{r.d(t,{B:()=>v}),r(6273);var n=r(25336),o=r(26110),i=r(80347),a=r(19913),s=r(3800),l=r(45773),c=r(10875),d=r(73411),u=r(61723),p=r(32685),h=r(26421),f=r(33763),m=r(93550);class v extends d.J{get geometries(){return this._geometries}get transformation(){return this._transformation??o.zK}set transformation(e){this._transformation=(0,n.C)(this._transformation??(0,o.vt)(),e),this._invalidateBoundingVolume(),this._emit("transformationChanged",this)}get shaderTransformation(){return this._shaderTransformation}set shaderTransformation(e){this._shaderTransformation=e?(0,n.C)(this._shaderTransformation??(0,o.vt)(),e):null,this._invalidateBoundingVolume(),this._emit("shaderTransformationChanged",this)}get effectiveTransformation(){return this.shaderTransformation??this.transformation}constructor(e={}){super(),this.type=u.X.Object,this._shaderTransformation=null,this._parentLayer=null,this._visible=!0,this.castShadow=e.castShadow??!0,this.usesVerticalDistanceToGround=e.usesVerticalDistanceToGround??!1,this.graphicUid=e.graphicUid,this.layerUid=e.layerUid,e.isElevationSource&&(this.lastValidElevationBB=new g),this._geometries=e.geometries?Array.from(e.geometries):new Array}dispose(){this._geometries.length=0}get parentLayer(){return this._parentLayer}set parentLayer(e){(0,h.vA)(null==this._parentLayer||null==e,"Object3D can only be added to a single Layer"),this._parentLayer=e}addGeometry(e){e.visible=this._visible,this._geometries.push(e),this._emit("geometryAdded",{object:this,geometry:e}),this._invalidateBoundingVolume()}removeGeometry(e){const t=this._geometries.splice(e,1)[0];t&&(this._emit("geometryRemoved",{object:this,geometry:t}),this._invalidateBoundingVolume())}removeAllGeometries(){for(;this._geometries.length>0;)this.removeGeometry(0)}geometryVertexAttributeUpdated(e,t,r=!1){this._emit("attributesChanged",{object:this,geometry:e,attribute:t,sync:r}),(0,f.b)(t)&&this._invalidateBoundingVolume()}get visible(){return this._visible}set visible(e){if(this._visible!==e){this._visible=e;for(const e of this._geometries)e.visible=this._visible;this._emit("visibilityChanged",this)}}maskOccludee(){const e=new p.p;for(const t of this._geometries)t.occludees=(0,m.Ci)(t.occludees,e);return this._emit("occlusionChanged",this),e}removeOcclude(e){for(const t of this._geometries)t.occludees=(0,m.PC)(t.occludees,e);this._emit("occlusionChanged",this)}highlight(e){const t=new p.h(e);for(const e of this._geometries)e.addHighlight(t);return this._emit("highlightChanged",this),t}removeHighlight(e){for(const t of this._geometries)t.removeHighlight(e);this._emit("highlightChanged",this)}removeStateID(e){e.channel===c.Mg.Highlight?this.removeHighlight(e):this.removeOcclude(e)}getCombinedStaticTransformation(e,t){return(0,n.lw)(t,this.transformation,e.transformation)}getCombinedShaderTransformation(e,t=(0,o.vt)()){return(0,n.lw)(t,this.effectiveTransformation,e.transformation)}get boundingVolumeWorldSpace(){return this._bvWorldSpace||(this._bvWorldSpace=this._bvWorldSpace||new y,this._validateBoundingVolume(this._bvWorldSpace,T.WorldSpace)),this._bvWorldSpace}get boundingVolumeObjectSpace(){return this._bvObjectSpace||(this._bvObjectSpace=this._bvObjectSpace||new y,this._validateBoundingVolume(this._bvObjectSpace,T.ObjectSpace)),this._bvObjectSpace}_validateBoundingVolume(e,t){const r=t===T.ObjectSpace;for(const t of this._geometries){const n=t.boundingInfo;n&&_(n,e,r?t.transformation:this.getCombinedShaderTransformation(t))}(0,i.m)((0,s.a)(e.bounds),e.min,e.max,.5);for(const t of this._geometries){const n=t.boundingInfo;if(null==n)continue;const o=r?t.transformation:this.getCombinedShaderTransformation(t),a=(0,l.hG)(o);(0,i.t)(S,n.center,o);const c=(0,i.j)(S,(0,s.a)(e.bounds)),d=n.radius*a;e.bounds[3]=Math.max(e.bounds[3],c+d)}}_invalidateBoundingVolume(){const e=this._bvWorldSpace?.bounds;this._bvObjectSpace=this._bvWorldSpace=void 0,this._parentLayer&&e&&this._parentLayer.notifyObjectBBChanged(this,e)}_emit(e,t){this._parentLayer&&this._parentLayer.events.emit(e,t)}get test(){}}class g{constructor(){this.min=(0,a.fA)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.max=(0,a.fA)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.max[0]<this.min[0]&&this.max[1]<this.min[1]&&this.max[2]<this.min[2]}}class y extends g{constructor(){super(...arguments),this.bounds=(0,s.c)()}}function _(e,t,r){const o=e.bbMin,a=e.bbMax;if((0,n.tZ)(r)){const e=(0,i.i)(w,r[12],r[13],r[14]);(0,i.g)(E,o,e),(0,i.g)(b,a,e);for(let e=0;e<3;++e)t.min[e]=Math.min(t.min[e],E[e]),t.max[e]=Math.max(t.max[e],b[e])}else if((0,i.t)(E,o,r),(0,i.p)(o,a))for(let e=0;e<3;++e)t.min[e]=Math.min(t.min[e],E[e]),t.max[e]=Math.max(t.max[e],E[e]);else{(0,i.t)(b,a,r);for(let e=0;e<3;++e)t.min[e]=Math.min(t.min[e],E[e],b[e]),t.max[e]=Math.max(t.max[e],E[e],b[e]);for(let e=0;e<3;++e){(0,i.c)(E,o),(0,i.c)(b,a),E[e]=a[e],b[e]=o[e],(0,i.t)(E,E,r),(0,i.t)(b,b,r);for(let e=0;e<3;++e)t.min[e]=Math.min(t.min[e],E[e],b[e]),t.max[e]=Math.max(t.max[e],E[e],b[e])}}}const w=(0,a.vt)(),E=(0,a.vt)(),b=(0,a.vt)(),S=(0,a.vt)();var T,A;(A=T||(T={}))[A.WorldSpace=0]="WorldSpace",A[A.ObjectSpace=1]="ObjectSpace"},58304:(e,t,r)=>{r.d(t,{G:()=>n,Q:()=>o});const n={stableRendering:!1},o={rootOrigin:null}},63654:(e,t,r)=>{r.r(t),r.d(t,{l:()=>s});var n,o=r(90618),i={exports:{}};const a=(0,o.g)(function(){return n||(n=1,e=i,t="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,r=function(e={}){var r,n,i=e;i.ready=new Promise(((e,t)=>{r=e,n=t}));var a,s,l=Object.assign({},i),c="./this.program",d=(e,t)=>{throw t},u="";"undefined"!=typeof document&&document.currentScript&&(u=document.currentScript.src),t&&(u=t),u=0!==u.indexOf("blob:")?u.substr(0,u.replace(/[?#].*/,"").lastIndexOf("/")+1):"",a=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},s=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)};var p,h,f=i.print||console.log.bind(console),m=i.printErr||console.error.bind(console);Object.assign(i,l),l=null,i.arguments&&i.arguments,i.thisProgram&&(c=i.thisProgram),i.quit&&(d=i.quit),i.wasmBinary&&(p=i.wasmBinary),"object"!=typeof WebAssembly&&N("no native wasm support detected");var v,g,y,_,w,E,b,S,T=!1;function A(e,t){e||N(t)}function O(){var e=h.buffer;i.HEAP8=v=new Int8Array(e),i.HEAP16=y=new Int16Array(e),i.HEAPU8=g=new Uint8Array(e),i.HEAPU16=_=new Uint16Array(e),i.HEAP32=w=new Int32Array(e),i.HEAPU32=E=new Uint32Array(e),i.HEAPF32=b=new Float32Array(e),i.HEAPF64=S=new Float64Array(e)}var D=[],R=[],C=[];function x(e){D.unshift(e)}function P(e){C.unshift(e)}var F=0,k=null;function L(e){F++,i.monitorRunDependencies&&i.monitorRunDependencies(F)}function I(e){if(F--,i.monitorRunDependencies&&i.monitorRunDependencies(F),0==F&&k){var t=k;k=null,t()}}function N(e){i.onAbort&&i.onAbort(e),m(e="Aborted("+e+")"),T=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw n(t),t}var M,j,W,z,U=e=>e.startsWith("data:application/octet-stream;base64,");function H(e){if(e==M&&p)return new Uint8Array(p);throw"both async and sync fetching of the wasm failed"}function $(e,t,r){return function(e){return p||"function"!=typeof fetch?Promise.resolve().then((()=>H(e))):fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>H(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{m(`failed to asynchronously prepare wasm: ${e}`),N(e)}))}function B(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}U(M="lyr3DWorker.wasm")||(z=M,M=i.locateFile?i.locateFile(z,u):u+z);var V=e=>{for(;e.length>0;)e.shift()(i)},G=i.noExitRuntime||!0;function J(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(e){E[this.ptr+4>>2]=e},this.get_type=function(){return E[this.ptr+4>>2]},this.set_destructor=function(e){E[this.ptr+8>>2]=e},this.get_destructor=function(){return E[this.ptr+8>>2]},this.set_caught=function(e){e=e?1:0,v[this.ptr+12|0]=e},this.get_caught=function(){return 0!=v[this.ptr+12|0]},this.set_rethrown=function(e){e=e?1:0,v[this.ptr+13|0]=e},this.get_rethrown=function(){return 0!=v[this.ptr+13|0]},this.init=function(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t)},this.set_adjusted_ptr=function(e){E[this.ptr+16>>2]=e},this.get_adjusted_ptr=function(){return E[this.ptr+16>>2]},this.get_exception_ptr=function(){if(Tt(this.get_type()))return E[this.excPtr>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}var Y={isAbs:e=>"/"===e.charAt(0),splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:e=>{var t=Y.isAbs(e),r="/"===e.substr(-1);return(e=Y.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=Y.splitPath(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},basename:e=>{if("/"===e)return"/";var t=(e=(e=Y.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},join:function(){var e=Array.prototype.slice.call(arguments);return Y.normalize(e.join("/"))},join2:(e,t)=>Y.normalize(e+"/"+t)},q=e=>(q=(()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return e=>crypto.getRandomValues(e);N("initRandomDevice")})())(e),X={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:ce.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t=Y.isAbs(n)}return(t?"/":"")+(e=Y.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||"."},relative:(e,t)=>{function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=X.resolve(e).substr(1),t=X.resolve(t).substr(1);for(var n=r(e.split("/")),o=r(t.split("/")),i=Math.min(n.length,o.length),a=i,s=0;s<i;s++)if(n[s]!==o[s]){a=s;break}var l=[];for(s=a;s<n.length;s++)l.push("..");return(l=l.concat(o.slice(a))).join("/")}},Z="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,Q=(e,t,r)=>{for(var n=t+r,o=t;e[o]&&!(o>=n);)++o;if(o-t>16&&e.buffer&&Z)return Z.decode(e.subarray(t,o));for(var i="";t<o;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var l=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|l:(7&a)<<18|s<<12|l<<6|63&e[t++])<65536)i+=String.fromCharCode(a);else{var c=a-65536;i+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else i+=String.fromCharCode((31&a)<<6|s)}else i+=String.fromCharCode(a)}return i},K=[],ee=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++r):t+=3}return t},te=(e,t,r,n)=>{if(!(n>0))return 0;for(var o=r,i=r+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(r>=i)break;t[r++]=s}else if(s<=2047){if(r+1>=i)break;t[r++]=192|s>>6,t[r++]=128|63&s}else if(s<=65535){if(r+2>=i)break;t[r++]=224|s>>12,t[r++]=128|s>>6&63,t[r++]=128|63&s}else{if(r+3>=i)break;t[r++]=240|s>>18,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}}return t[r]=0,r-o};function re(e,t,r){var n=ee(e)+1,o=new Array(n),i=te(e,o,0,o.length);return t&&(o.length=i),o}var ne={ttys:[],init(){},shutdown(){},register(e,t){ne.ttys[e]={input:[],output:[],ops:t},ce.registerDevice(e,ne.stream_ops)},stream_ops:{open(e){var t=ne.ttys[e.node.rdev];if(!t)throw new ce.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,r,n,o){if(!e.tty||!e.tty.ops.get_char)throw new ce.ErrnoError(60);for(var i=0,a=0;a<n;a++){var s;try{s=e.tty.ops.get_char(e.tty)}catch(e){throw new ce.ErrnoError(29)}if(void 0===s&&0===i)throw new ce.ErrnoError(6);if(null==s)break;i++,t[r+a]=s}return i&&(e.node.timestamp=Date.now()),i},write(e,t,r,n,o){if(!e.tty||!e.tty.ops.put_char)throw new ce.ErrnoError(60);try{for(var i=0;i<n;i++)e.tty.ops.put_char(e.tty,t[r+i])}catch(e){throw new ce.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),i}},default_tty_ops:{get_char:e=>(()=>{if(!K.length){var e=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(e=window.prompt("Input: "))&&(e+="\n"):"function"==typeof readline&&null!==(e=readline())&&(e+="\n"),!e)return null;K=re(e,!0)}return K.shift()})(),put_char(e,t){null===t||10===t?(f(Q(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(f(Q(e.output,0)),e.output=[])},ioctl_tcgets:e=>({c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}),ioctl_tcsets:(e,t,r)=>0,ioctl_tiocgwinsz:e=>[24,80]},default_tty1_ops:{put_char(e,t){null===t||10===t?(m(Q(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output&&e.output.length>0&&(m(Q(e.output,0)),e.output=[])}}},oe=e=>{N()},ie={ops_table:null,mount:e=>ie.createNode(null,"/",16895,0),createNode(e,t,r,n){if(ce.isBlkdev(r)||ce.isFIFO(r))throw new ce.ErrnoError(63);ie.ops_table||(ie.ops_table={dir:{node:{getattr:ie.node_ops.getattr,setattr:ie.node_ops.setattr,lookup:ie.node_ops.lookup,mknod:ie.node_ops.mknod,rename:ie.node_ops.rename,unlink:ie.node_ops.unlink,rmdir:ie.node_ops.rmdir,readdir:ie.node_ops.readdir,symlink:ie.node_ops.symlink},stream:{llseek:ie.stream_ops.llseek}},file:{node:{getattr:ie.node_ops.getattr,setattr:ie.node_ops.setattr},stream:{llseek:ie.stream_ops.llseek,read:ie.stream_ops.read,write:ie.stream_ops.write,allocate:ie.stream_ops.allocate,mmap:ie.stream_ops.mmap,msync:ie.stream_ops.msync}},link:{node:{getattr:ie.node_ops.getattr,setattr:ie.node_ops.setattr,readlink:ie.node_ops.readlink},stream:{}},chrdev:{node:{getattr:ie.node_ops.getattr,setattr:ie.node_ops.setattr},stream:ce.chrdev_stream_ops}});var o=ce.createNode(e,t,r,n);return ce.isDir(o.mode)?(o.node_ops=ie.ops_table.dir.node,o.stream_ops=ie.ops_table.dir.stream,o.contents={}):ce.isFile(o.mode)?(o.node_ops=ie.ops_table.file.node,o.stream_ops=ie.ops_table.file.stream,o.usedBytes=0,o.contents=null):ce.isLink(o.mode)?(o.node_ops=ie.ops_table.link.node,o.stream_ops=ie.ops_table.link.stream):ce.isChrdev(o.mode)&&(o.node_ops=ie.ops_table.chrdev.node,o.stream_ops=ie.ops_table.chrdev.stream),o.timestamp=Date.now(),e&&(e.contents[t]=o,e.timestamp=o.timestamp),o},getFileDataAsTypedArray:e=>e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0),expandFileStorage(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){t=Math.max(t,r*(r<1048576?2:1.125)>>>0),0!=r&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var r=e.contents;e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=ce.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,ce.isDir(e.mode)?t.size=4096:ce.isFile(e.mode)?t.size=e.usedBytes:ce.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&ie.resizeFileStorage(e,t.size)},lookup(e,t){throw ce.genericErrors[44]},mknod:(e,t,r,n)=>ie.createNode(e,t,r,n),rename(e,t,r){if(ce.isDir(e.mode)){var n;try{n=ce.lookupNode(t,r)}catch(e){}if(n)for(var o in n.contents)throw new ce.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=r,t.contents[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir(e,t){var r=ce.lookupNode(e,t);for(var n in r.contents)throw new ce.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink(e,t,r){var n=ie.createNode(e,t,41471,0);return n.link=r,n},readlink(e){if(!ce.isLink(e.mode))throw new ce.ErrnoError(28);return e.link}},stream_ops:{read(e,t,r,n,o){var i=e.node.contents;if(o>=e.node.usedBytes)return 0;var a=Math.min(e.node.usedBytes-o,n);if(a>8&&i.subarray)t.set(i.subarray(o,o+a),r);else for(var s=0;s<a;s++)t[r+s]=i[o+s];return a},write(e,t,r,n,o,i){if(t.buffer===v.buffer&&(i=!1),!n)return 0;var a=e.node;if(a.timestamp=Date.now(),t.subarray&&(!a.contents||a.contents.subarray)){if(i)return a.contents=t.subarray(r,r+n),a.usedBytes=n,n;if(0===a.usedBytes&&0===o)return a.contents=t.slice(r,r+n),a.usedBytes=n,n;if(o+n<=a.usedBytes)return a.contents.set(t.subarray(r,r+n),o),n}if(ie.expandFileStorage(a,o+n),a.contents.subarray&&t.subarray)a.contents.set(t.subarray(r,r+n),o);else for(var s=0;s<n;s++)a.contents[o+s]=t[r+s];return a.usedBytes=Math.max(a.usedBytes,o+n),n},llseek(e,t,r){var n=t;if(1===r?n+=e.position:2===r&&ce.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new ce.ErrnoError(28);return n},allocate(e,t,r){ie.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap(e,t,r,n,o){if(!ce.isFile(e.node.mode))throw new ce.ErrnoError(43);var i,a,s=e.node.contents;if(2&o||s.buffer!==v.buffer){if((r>0||r+t<s.length)&&(s=s.subarray?s.subarray(r,r+t):Array.prototype.slice.call(s,r,r+t)),a=!0,!(i=oe()))throw new ce.ErrnoError(48);v.set(s,i)}else a=!1,i=s.byteOffset;return{ptr:i,allocated:a}},msync:(e,t,r,n,o)=>(ie.stream_ops.write(e,t,0,n,r,!1),0)}},ae=(e,t,r,n)=>{var o=`al ${e}`;s(e,(r=>{A(r,`Loading data file "${e}" failed (no arrayBuffer).`),t(new Uint8Array(r)),o&&I()}),(t=>{if(!r)throw`Loading data file "${e}" failed.`;r()})),o&&L()},se=i.preloadPlugins||[],le=(e,t)=>{var r=0;return e&&(r|=365),t&&(r|=146),r},ce={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath(e,t={}){if(!(e=X.resolve(e)))return{path:"",node:null};if((t=Object.assign({follow_mount:!0,recurse_count:0},t)).recurse_count>8)throw new ce.ErrnoError(32);for(var r=e.split("/").filter((e=>!!e)),n=ce.root,o="/",i=0;i<r.length;i++){var a=i===r.length-1;if(a&&t.parent)break;if(n=ce.lookupNode(n,r[i]),o=Y.join2(o,r[i]),ce.isMountpoint(n)&&(!a||a&&t.follow_mount)&&(n=n.mounted.root),!a||t.follow)for(var s=0;ce.isLink(n.mode);){var l=ce.readlink(o);if(o=X.resolve(Y.dirname(o),l),n=ce.lookupPath(o,{recurse_count:t.recurse_count+1}).node,s++>40)throw new ce.ErrnoError(32)}}return{path:o,node:n}},getPath(e){for(var t;;){if(ce.isRoot(e)){var r=e.mount.mountpoint;return t?"/"!==r[r.length-1]?`${r}/${t}`:r+t:r}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%ce.nameTable.length},hashAddNode(e){var t=ce.hashName(e.parent.id,e.name);e.name_next=ce.nameTable[t],ce.nameTable[t]=e},hashRemoveNode(e){var t=ce.hashName(e.parent.id,e.name);if(ce.nameTable[t]===e)ce.nameTable[t]=e.name_next;else for(var r=ce.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode(e,t){var r=ce.mayLookup(e);if(r)throw new ce.ErrnoError(r,e);for(var n=ce.hashName(e.id,t),o=ce.nameTable[n];o;o=o.name_next){var i=o.name;if(o.parent.id===e.id&&i===t)return o}return ce.lookup(e,t)},createNode(e,t,r,n){var o=new ce.FSNode(e,t,r,n);return ce.hashAddNode(o),o},destroyNode(e){ce.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>32768==(61440&e),isDir:e=>16384==(61440&e),isLink:e=>40960==(61440&e),isChrdev:e=>8192==(61440&e),isBlkdev:e=>24576==(61440&e),isFIFO:e=>4096==(61440&e),isSocket:e=>!(49152&~e),flagsToPermissionString(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:(e,t)=>ce.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2,mayLookup:e=>ce.nodePermissions(e,"x")||(e.node_ops.lookup?0:2),mayCreate(e,t){try{return ce.lookupNode(e,t),20}catch(e){}return ce.nodePermissions(e,"wx")},mayDelete(e,t,r){var n;try{n=ce.lookupNode(e,t)}catch(e){return e.errno}var o=ce.nodePermissions(e,"wx");if(o)return o;if(r){if(!ce.isDir(n.mode))return 54;if(ce.isRoot(n)||ce.getPath(n)===ce.cwd())return 10}else if(ce.isDir(n.mode))return 31;return 0},mayOpen:(e,t)=>e?ce.isLink(e.mode)?32:ce.isDir(e.mode)&&("r"!==ce.flagsToPermissionString(t)||512&t)?31:ce.nodePermissions(e,ce.flagsToPermissionString(t)):44,MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=ce.MAX_OPEN_FDS;e++)if(!ce.streams[e])return e;throw new ce.ErrnoError(33)},getStreamChecked(e){var t=ce.getStream(e);if(!t)throw new ce.ErrnoError(8);return t},getStream:e=>ce.streams[e],createStream:(e,t=-1)=>(ce.FSStream||(ce.FSStream=function(){this.shared={}},ce.FSStream.prototype={},Object.defineProperties(ce.FSStream.prototype,{object:{get(){return this.node},set(e){this.node=e}},isRead:{get(){return 1!=(2097155&this.flags)}},isWrite:{get(){return!!(2097155&this.flags)}},isAppend:{get(){return 1024&this.flags}},flags:{get(){return this.shared.flags},set(e){this.shared.flags=e}},position:{get(){return this.shared.position},set(e){this.shared.position=e}}})),e=Object.assign(new ce.FSStream,e),-1==t&&(t=ce.nextfd()),e.fd=t,ce.streams[t]=e,e),closeStream(e){ce.streams[e]=null},chrdev_stream_ops:{open(e){var t=ce.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek(){throw new ce.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice(e,t){ce.devices[e]={stream_ops:t}},getDevice:e=>ce.devices[e],getMounts(e){for(var t=[],r=[e];r.length;){var n=r.pop();t.push(n),r.push.apply(r,n.mounts)}return t},syncfs(e,t){"function"==typeof e&&(t=e,e=!1),ce.syncFSRequests++,ce.syncFSRequests>1&&m(`warning: ${ce.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var r=ce.getMounts(ce.root.mount),n=0;function o(e){return ce.syncFSRequests--,t(e)}function i(e){if(e)return i.errored?void 0:(i.errored=!0,o(e));++n>=r.length&&o(null)}r.forEach((t=>{if(!t.type.syncfs)return i(null);t.type.syncfs(t,e,i)}))},mount(e,t,r){var n,o="/"===r,i=!r;if(o&&ce.root)throw new ce.ErrnoError(10);if(!o&&!i){var a=ce.lookupPath(r,{follow_mount:!1});if(r=a.path,n=a.node,ce.isMountpoint(n))throw new ce.ErrnoError(10);if(!ce.isDir(n.mode))throw new ce.ErrnoError(54)}var s={type:e,opts:t,mountpoint:r,mounts:[]},l=e.mount(s);return l.mount=s,s.root=l,o?ce.root=l:n&&(n.mounted=s,n.mount&&n.mount.mounts.push(s)),l},unmount(e){var t=ce.lookupPath(e,{follow_mount:!1});if(!ce.isMountpoint(t.node))throw new ce.ErrnoError(28);var r=t.node,n=r.mounted,o=ce.getMounts(n);Object.keys(ce.nameTable).forEach((e=>{for(var t=ce.nameTable[e];t;){var r=t.name_next;o.includes(t.mount)&&ce.destroyNode(t),t=r}})),r.mounted=null;var i=r.mount.mounts.indexOf(n);r.mount.mounts.splice(i,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod(e,t,r){var n=ce.lookupPath(e,{parent:!0}).node,o=Y.basename(e);if(!o||"."===o||".."===o)throw new ce.ErrnoError(28);var i=ce.mayCreate(n,o);if(i)throw new ce.ErrnoError(i);if(!n.node_ops.mknod)throw new ce.ErrnoError(63);return n.node_ops.mknod(n,o,t,r)},create:(e,t)=>(t=void 0!==t?t:438,t&=4095,t|=32768,ce.mknod(e,t,0)),mkdir:(e,t)=>(t=void 0!==t?t:511,t&=1023,t|=16384,ce.mknod(e,t,0)),mkdirTree(e,t){for(var r=e.split("/"),n="",o=0;o<r.length;++o)if(r[o]){n+="/"+r[o];try{ce.mkdir(n,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:(e,t,r)=>(void 0===r&&(r=t,t=438),t|=8192,ce.mknod(e,t,r)),symlink(e,t){if(!X.resolve(e))throw new ce.ErrnoError(44);var r=ce.lookupPath(t,{parent:!0}).node;if(!r)throw new ce.ErrnoError(44);var n=Y.basename(t),o=ce.mayCreate(r,n);if(o)throw new ce.ErrnoError(o);if(!r.node_ops.symlink)throw new ce.ErrnoError(63);return r.node_ops.symlink(r,n,e)},rename(e,t){var r,n,o=Y.dirname(e),i=Y.dirname(t),a=Y.basename(e),s=Y.basename(t);if(r=ce.lookupPath(e,{parent:!0}).node,n=ce.lookupPath(t,{parent:!0}).node,!r||!n)throw new ce.ErrnoError(44);if(r.mount!==n.mount)throw new ce.ErrnoError(75);var l,c=ce.lookupNode(r,a),d=X.relative(e,i);if("."!==d.charAt(0))throw new ce.ErrnoError(28);if("."!==(d=X.relative(t,o)).charAt(0))throw new ce.ErrnoError(55);try{l=ce.lookupNode(n,s)}catch(e){}if(c!==l){var u=ce.isDir(c.mode),p=ce.mayDelete(r,a,u);if(p)throw new ce.ErrnoError(p);if(p=l?ce.mayDelete(n,s,u):ce.mayCreate(n,s))throw new ce.ErrnoError(p);if(!r.node_ops.rename)throw new ce.ErrnoError(63);if(ce.isMountpoint(c)||l&&ce.isMountpoint(l))throw new ce.ErrnoError(10);if(n!==r&&(p=ce.nodePermissions(r,"w")))throw new ce.ErrnoError(p);ce.hashRemoveNode(c);try{r.node_ops.rename(c,n,s)}catch(e){throw e}finally{ce.hashAddNode(c)}}},rmdir(e){var t=ce.lookupPath(e,{parent:!0}).node,r=Y.basename(e),n=ce.lookupNode(t,r),o=ce.mayDelete(t,r,!0);if(o)throw new ce.ErrnoError(o);if(!t.node_ops.rmdir)throw new ce.ErrnoError(63);if(ce.isMountpoint(n))throw new ce.ErrnoError(10);t.node_ops.rmdir(t,r),ce.destroyNode(n)},readdir(e){var t=ce.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new ce.ErrnoError(54);return t.node_ops.readdir(t)},unlink(e){var t=ce.lookupPath(e,{parent:!0}).node;if(!t)throw new ce.ErrnoError(44);var r=Y.basename(e),n=ce.lookupNode(t,r),o=ce.mayDelete(t,r,!1);if(o)throw new ce.ErrnoError(o);if(!t.node_ops.unlink)throw new ce.ErrnoError(63);if(ce.isMountpoint(n))throw new ce.ErrnoError(10);t.node_ops.unlink(t,r),ce.destroyNode(n)},readlink(e){var t=ce.lookupPath(e).node;if(!t)throw new ce.ErrnoError(44);if(!t.node_ops.readlink)throw new ce.ErrnoError(28);return X.resolve(ce.getPath(t.parent),t.node_ops.readlink(t))},stat(e,t){var r=ce.lookupPath(e,{follow:!t}).node;if(!r)throw new ce.ErrnoError(44);if(!r.node_ops.getattr)throw new ce.ErrnoError(63);return r.node_ops.getattr(r)},lstat:e=>ce.stat(e,!0),chmod(e,t,r){var n;if(!(n="string"==typeof e?ce.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new ce.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod(e,t){ce.chmod(e,t,!0)},fchmod(e,t){var r=ce.getStreamChecked(e);ce.chmod(r.node,t)},chown(e,t,r,n){var o;if(!(o="string"==typeof e?ce.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new ce.ErrnoError(63);o.node_ops.setattr(o,{timestamp:Date.now()})},lchown(e,t,r){ce.chown(e,t,r,!0)},fchown(e,t,r){var n=ce.getStreamChecked(e);ce.chown(n.node,t,r)},truncate(e,t){if(t<0)throw new ce.ErrnoError(28);var r;if(!(r="string"==typeof e?ce.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new ce.ErrnoError(63);if(ce.isDir(r.mode))throw new ce.ErrnoError(31);if(!ce.isFile(r.mode))throw new ce.ErrnoError(28);var n=ce.nodePermissions(r,"w");if(n)throw new ce.ErrnoError(n);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate(e,t){var r=ce.getStreamChecked(e);if(!(2097155&r.flags))throw new ce.ErrnoError(28);ce.truncate(r.node,t)},utime(e,t,r){var n=ce.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,r)})},open(e,t,r){if(""===e)throw new ce.ErrnoError(44);var n;if(r=void 0===r?438:r,r=64&(t="string"==typeof t?(e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(void 0===t)throw new Error(`Unknown file open mode: ${e}`);return t})(t):t)?4095&r|32768:0,"object"==typeof e)n=e;else{e=Y.normalize(e);try{n=ce.lookupPath(e,{follow:!(131072&t)}).node}catch(e){}}var o=!1;if(64&t)if(n){if(128&t)throw new ce.ErrnoError(20)}else n=ce.mknod(e,r,0),o=!0;if(!n)throw new ce.ErrnoError(44);if(ce.isChrdev(n.mode)&&(t&=-513),65536&t&&!ce.isDir(n.mode))throw new ce.ErrnoError(54);if(!o){var a=ce.mayOpen(n,t);if(a)throw new ce.ErrnoError(a)}512&t&&!o&&ce.truncate(n,0),t&=-131713;var s=ce.createStream({node:n,path:ce.getPath(n),flags:t,seekable:!0,position:0,stream_ops:n.stream_ops,ungotten:[],error:!1});return s.stream_ops.open&&s.stream_ops.open(s),!i.logReadFiles||1&t||(ce.readFiles||(ce.readFiles={}),e in ce.readFiles||(ce.readFiles[e]=1)),s},close(e){if(ce.isClosed(e))throw new ce.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{ce.closeStream(e.fd)}e.fd=null},isClosed:e=>null===e.fd,llseek(e,t,r){if(ce.isClosed(e))throw new ce.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new ce.ErrnoError(70);if(0!=r&&1!=r&&2!=r)throw new ce.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read(e,t,r,n,o){if(n<0||o<0)throw new ce.ErrnoError(28);if(ce.isClosed(e))throw new ce.ErrnoError(8);if(1==(2097155&e.flags))throw new ce.ErrnoError(8);if(ce.isDir(e.node.mode))throw new ce.ErrnoError(31);if(!e.stream_ops.read)throw new ce.ErrnoError(28);var i=void 0!==o;if(i){if(!e.seekable)throw new ce.ErrnoError(70)}else o=e.position;var a=e.stream_ops.read(e,t,r,n,o);return i||(e.position+=a),a},write(e,t,r,n,o,i){if(n<0||o<0)throw new ce.ErrnoError(28);if(ce.isClosed(e))throw new ce.ErrnoError(8);if(!(2097155&e.flags))throw new ce.ErrnoError(8);if(ce.isDir(e.node.mode))throw new ce.ErrnoError(31);if(!e.stream_ops.write)throw new ce.ErrnoError(28);e.seekable&&1024&e.flags&&ce.llseek(e,0,2);var a=void 0!==o;if(a){if(!e.seekable)throw new ce.ErrnoError(70)}else o=e.position;var s=e.stream_ops.write(e,t,r,n,o,i);return a||(e.position+=s),s},allocate(e,t,r){if(ce.isClosed(e))throw new ce.ErrnoError(8);if(t<0||r<=0)throw new ce.ErrnoError(28);if(!(2097155&e.flags))throw new ce.ErrnoError(8);if(!ce.isFile(e.node.mode)&&!ce.isDir(e.node.mode))throw new ce.ErrnoError(43);if(!e.stream_ops.allocate)throw new ce.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap(e,t,r,n,o){if(2&n&&!(2&o)&&2!=(2097155&e.flags))throw new ce.ErrnoError(2);if(1==(2097155&e.flags))throw new ce.ErrnoError(2);if(!e.stream_ops.mmap)throw new ce.ErrnoError(43);return e.stream_ops.mmap(e,t,r,n,o)},msync:(e,t,r,n,o)=>e.stream_ops.msync?e.stream_ops.msync(e,t,r,n,o):0,munmap:e=>0,ioctl(e,t,r){if(!e.stream_ops.ioctl)throw new ce.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile(e,t={}){if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error(`Invalid encoding type "${t.encoding}"`);var r,n=ce.open(e,t.flags),o=ce.stat(e).size,i=new Uint8Array(o);return ce.read(n,i,0,o,0),"utf8"===t.encoding?r=Q(i,0):"binary"===t.encoding&&(r=i),ce.close(n),r},writeFile(e,t,r={}){r.flags=r.flags||577;var n=ce.open(e,r.flags,r.mode);if("string"==typeof t){var o=new Uint8Array(ee(t)+1),i=te(t,o,0,o.length);ce.write(n,o,0,i,void 0,r.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");ce.write(n,t,0,t.byteLength,void 0,r.canOwn)}ce.close(n)},cwd:()=>ce.currentPath,chdir(e){var t=ce.lookupPath(e,{follow:!0});if(null===t.node)throw new ce.ErrnoError(44);if(!ce.isDir(t.node.mode))throw new ce.ErrnoError(54);var r=ce.nodePermissions(t.node,"x");if(r)throw new ce.ErrnoError(r);ce.currentPath=t.path},createDefaultDirectories(){ce.mkdir("/tmp"),ce.mkdir("/home"),ce.mkdir("/home/web_user")},createDefaultDevices(){ce.mkdir("/dev"),ce.registerDevice(ce.makedev(1,3),{read:()=>0,write:(e,t,r,n,o)=>n}),ce.mkdev("/dev/null",ce.makedev(1,3)),ne.register(ce.makedev(5,0),ne.default_tty_ops),ne.register(ce.makedev(6,0),ne.default_tty1_ops),ce.mkdev("/dev/tty",ce.makedev(5,0)),ce.mkdev("/dev/tty1",ce.makedev(6,0));var e=new Uint8Array(1024),t=0,r=()=>(0===t&&(t=q(e).byteLength),e[--t]);ce.createDevice("/dev","random",r),ce.createDevice("/dev","urandom",r),ce.mkdir("/dev/shm"),ce.mkdir("/dev/shm/tmp")},createSpecialDirectories(){ce.mkdir("/proc");var e=ce.mkdir("/proc/self");ce.mkdir("/proc/self/fd"),ce.mount({mount(){var t=ce.createNode(e,"fd",16895,73);return t.node_ops={lookup(e,t){var r=+t,n=ce.getStreamChecked(r),o={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>n.path}};return o.parent=o,o}},t}},{},"/proc/self/fd")},createStandardStreams(){i.stdin?ce.createDevice("/dev","stdin",i.stdin):ce.symlink("/dev/tty","/dev/stdin"),i.stdout?ce.createDevice("/dev","stdout",null,i.stdout):ce.symlink("/dev/tty","/dev/stdout"),i.stderr?ce.createDevice("/dev","stderr",null,i.stderr):ce.symlink("/dev/tty1","/dev/stderr"),ce.open("/dev/stdin",0),ce.open("/dev/stdout",1),ce.open("/dev/stderr",1)},ensureErrnoError(){ce.ErrnoError||(ce.ErrnoError=function(e,t){this.name="ErrnoError",this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},ce.ErrnoError.prototype=new Error,ce.ErrnoError.prototype.constructor=ce.ErrnoError,[44].forEach((e=>{ce.genericErrors[e]=new ce.ErrnoError(e),ce.genericErrors[e].stack="<generic error, no stack>"})))},staticInit(){ce.ensureErrnoError(),ce.nameTable=new Array(4096),ce.mount(ie,{},"/"),ce.createDefaultDirectories(),ce.createDefaultDevices(),ce.createSpecialDirectories(),ce.filesystems={MEMFS:ie}},init(e,t,r){ce.init.initialized=!0,ce.ensureErrnoError(),i.stdin=e||i.stdin,i.stdout=t||i.stdout,i.stderr=r||i.stderr,ce.createStandardStreams()},quit(){ce.init.initialized=!1;for(var e=0;e<ce.streams.length;e++){var t=ce.streams[e];t&&ce.close(t)}},findObject(e,t){var r=ce.analyzePath(e,t);return r.exists?r.object:null},analyzePath(e,t){try{e=(n=ce.lookupPath(e,{follow:!t})).path}catch(e){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=ce.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=n.path,r.parentObject=n.node,r.name=Y.basename(e),n=ce.lookupPath(e,{follow:!t}),r.exists=!0,r.path=n.path,r.object=n.node,r.name=n.node.name,r.isRoot="/"===n.path}catch(e){r.error=e.errno}return r},createPath(e,t,r,n){e="string"==typeof e?e:ce.getPath(e);for(var o=t.split("/").reverse();o.length;){var i=o.pop();if(i){var a=Y.join2(e,i);try{ce.mkdir(a)}catch(e){}e=a}}return a},createFile(e,t,r,n,o){var i=Y.join2("string"==typeof e?e:ce.getPath(e),t),a=le(n,o);return ce.create(i,a)},createDataFile(e,t,r,n,o,i){var a=t;e&&(e="string"==typeof e?e:ce.getPath(e),a=t?Y.join2(e,t):e);var s=le(n,o),l=ce.create(a,s);if(r){if("string"==typeof r){for(var c=new Array(r.length),d=0,u=r.length;d<u;++d)c[d]=r.charCodeAt(d);r=c}ce.chmod(l,146|s);var p=ce.open(l,577);ce.write(p,r,0,r.length,0,i),ce.close(p),ce.chmod(l,s)}return l},createDevice(e,t,r,n){var o=Y.join2("string"==typeof e?e:ce.getPath(e),t),i=le(!!r,!!n);ce.createDevice.major||(ce.createDevice.major=64);var a=ce.makedev(ce.createDevice.major++,0);return ce.registerDevice(a,{open(e){e.seekable=!1},close(e){n&&n.buffer&&n.buffer.length&&n(10)},read(e,t,n,o,i){for(var a=0,s=0;s<o;s++){var l;try{l=r()}catch(e){throw new ce.ErrnoError(29)}if(void 0===l&&0===a)throw new ce.ErrnoError(6);if(null==l)break;a++,t[n+s]=l}return a&&(e.node.timestamp=Date.now()),a},write(e,t,r,o,i){for(var a=0;a<o;a++)try{n(t[r+a])}catch(e){throw new ce.ErrnoError(29)}return o&&(e.node.timestamp=Date.now()),a}}),ce.mkdev(o,i,a)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!a)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=re(a(e.url),!0),e.usedBytes=e.contents.length}catch(e){throw new ce.ErrnoError(29)}},createLazyFile(e,t,r,n,o){function i(){this.lengthKnown=!1,this.chunks=[]}if(i.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,r=e/this.chunkSize|0;return this.getter(r)[t]}},i.prototype.setDataGetter=function(e){this.getter=e},i.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",r,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+r+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),o=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,i=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,a=1048576;o||(a=n);var s=(e,t)=>{if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var o=new XMLHttpRequest;if(o.open("GET",r,!1),n!==a&&o.setRequestHeader("Range","bytes="+e+"-"+t),o.responseType="arraybuffer",o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined"),o.send(null),!(o.status>=200&&o.status<300||304===o.status))throw new Error("Couldn't load "+r+". Status: "+o.status);return void 0!==o.response?new Uint8Array(o.response||[]):re(o.responseText||"",!0)},l=this;l.setDataGetter((e=>{var t=e*a,r=(e+1)*a-1;if(r=Math.min(r,n-1),void 0===l.chunks[e]&&(l.chunks[e]=s(t,r)),void 0===l.chunks[e])throw new Error("doXHR failed!");return l.chunks[e]})),!i&&n||(a=n=1,n=this.getter(0).length,a=n,f("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=a,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var a={isDevice:!1,url:r},s=ce.createFile(e,t,a,n,o);a.contents?s.contents=a.contents:a.url&&(s.contents=null,s.url=a.url),Object.defineProperties(s,{usedBytes:{get:function(){return this.contents.length}}});var l={};function c(e,t,r,n,o){var i=e.node.contents;if(o>=i.length)return 0;var a=Math.min(i.length-o,n);if(i.slice)for(var s=0;s<a;s++)t[r+s]=i[o+s];else for(s=0;s<a;s++)t[r+s]=i.get(o+s);return a}return Object.keys(s.stream_ops).forEach((e=>{var t=s.stream_ops[e];l[e]=function(){return ce.forceLoadFile(s),t.apply(null,arguments)}})),l.read=(e,t,r,n,o)=>(ce.forceLoadFile(s),c(e,t,r,n,o)),l.mmap=(e,t,r,n,o)=>{ce.forceLoadFile(s);var i=oe();if(!i)throw new ce.ErrnoError(48);return c(e,v,i,t,r),{ptr:i,allocated:!0}},s.stream_ops=l,s}},de=(e,t)=>e?Q(g,e,t):"",ue={DEFAULT_POLLMASK:5,calculateAt(e,t,r){if(Y.isAbs(t))return t;var n;if(n=-100===e?ce.cwd():ue.getStreamFromFD(e).path,0==t.length){if(!r)throw new ce.ErrnoError(44);return n}return Y.join2(n,t)},doStat(e,t,r){try{var n=e(t)}catch(e){if(e&&e.node&&Y.normalize(t)!==Y.normalize(ce.getPath(e.node)))return-54;throw e}w[r>>2]=n.dev,w[r+4>>2]=n.mode,E[r+8>>2]=n.nlink,w[r+12>>2]=n.uid,w[r+16>>2]=n.gid,w[r+20>>2]=n.rdev,W=[n.size>>>0,(j=n.size,+Math.abs(j)>=1?j>0?+Math.floor(j/4294967296)>>>0:~~+Math.ceil((j-+(~~j>>>0))/4294967296)>>>0:0)],w[r+24>>2]=W[0],w[r+28>>2]=W[1],w[r+32>>2]=4096,w[r+36>>2]=n.blocks;var o=n.atime.getTime(),i=n.mtime.getTime(),a=n.ctime.getTime();return W=[Math.floor(o/1e3)>>>0,(j=Math.floor(o/1e3),+Math.abs(j)>=1?j>0?+Math.floor(j/4294967296)>>>0:~~+Math.ceil((j-+(~~j>>>0))/4294967296)>>>0:0)],w[r+40>>2]=W[0],w[r+44>>2]=W[1],E[r+48>>2]=o%1e3*1e3,W=[Math.floor(i/1e3)>>>0,(j=Math.floor(i/1e3),+Math.abs(j)>=1?j>0?+Math.floor(j/4294967296)>>>0:~~+Math.ceil((j-+(~~j>>>0))/4294967296)>>>0:0)],w[r+56>>2]=W[0],w[r+60>>2]=W[1],E[r+64>>2]=i%1e3*1e3,W=[Math.floor(a/1e3)>>>0,(j=Math.floor(a/1e3),+Math.abs(j)>=1?j>0?+Math.floor(j/4294967296)>>>0:~~+Math.ceil((j-+(~~j>>>0))/4294967296)>>>0:0)],w[r+72>>2]=W[0],w[r+76>>2]=W[1],E[r+80>>2]=a%1e3*1e3,W=[n.ino>>>0,(j=n.ino,+Math.abs(j)>=1?j>0?+Math.floor(j/4294967296)>>>0:~~+Math.ceil((j-+(~~j>>>0))/4294967296)>>>0:0)],w[r+88>>2]=W[0],w[r+92>>2]=W[1],0},doMsync(e,t,r,n,o){if(!ce.isFile(t.node.mode))throw new ce.ErrnoError(43);if(2&n)return 0;var i=g.slice(e,e+r);ce.msync(t,i,o,r,n)},varargs:void 0,get(){var e=w[+ue.varargs>>2];return ue.varargs+=4,e},getp:()=>ue.get(),getStr:e=>de(e),getStreamFromFD:e=>ce.getStreamChecked(e)},pe={},he=e=>{for(;e.length;){var t=e.pop();e.pop()(t)}};function fe(e){return this.fromWireType(w[e>>2])}var me,ve,ge,ye={},_e={},we={},Ee=e=>{throw new me(e)},be=(e,t,r)=>{function n(t){var n=r(t);n.length!==e.length&&Ee("Mismatched type converter count");for(var o=0;o<e.length;++o)Ae(e[o],n[o])}e.forEach((function(e){we[e]=t}));var o=new Array(t.length),i=[],a=0;t.forEach(((e,t)=>{_e.hasOwnProperty(e)?o[t]=_e[e]:(i.push(e),ye.hasOwnProperty(e)||(ye[e]=[]),ye[e].push((()=>{o[t]=_e[e],++a===i.length&&n(o)})))})),0===i.length&&n(o)},Se=e=>{for(var t="",r=e;g[r];)t+=ve[g[r++]];return t},Te=e=>{throw new ge(e)};function Ae(e,t,r={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return function(e,t,r={}){var n=t.name;if(e||Te(`type "${n}" must have a positive integer typeid pointer`),_e.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;Te(`Cannot register type '${n}' twice`)}if(_e[e]=t,delete we[e],ye.hasOwnProperty(e)){var o=ye[e];delete ye[e],o.forEach((e=>e()))}}(e,t,r)}function Oe(){this.allocated=[void 0],this.freelist=[]}var De,Re,Ce=new Oe,xe=e=>{e>=Ce.reserved&&0==--Ce.get(e).refcount&&Ce.free(e)},Pe=e=>(e||Te("Cannot use deleted val. handle = "+e),Ce.get(e).value),Fe=e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Ce.allocate({refcount:1,value:e})}},ke=(e,t)=>{switch(t){case 4:return function(e){return this.fromWireType(b[e>>2])};case 8:return function(e){return this.fromWireType(S[e>>3])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},Le=(e,t,r)=>{if(void 0===e[t].overloadTable){var n=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||Te(`Function '${r}' called with an invalid number of arguments (${arguments.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[n.argCount]=n}},Ie=(e,t,r)=>{i.hasOwnProperty(e)?((void 0===r||void 0!==i[e].overloadTable&&void 0!==i[e].overloadTable[r])&&Te(`Cannot register public name '${e}' twice`),Le(i,e,e),i.hasOwnProperty(r)&&Te(`Cannot register multiple overloads of a function with the same number of arguments (${r})!`),i[e].overloadTable[r]=t):(i[e]=t,void 0!==r&&(i[e].numArguments=r))},Ne=(e,t,r)=>{i.hasOwnProperty(e)||Ee("Replacing nonexistant public symbol"),void 0!==i[e].overloadTable&&void 0!==r?i[e].overloadTable[r]=t:(i[e]=t,i[e].argCount=r)},Me=[],je=e=>{var t=Me[e];return t||(e>=Me.length&&(Me.length=e+1),Me[e]=t=De.get(e)),t},We=(e,t)=>{var r=(e=Se(e)).includes("j")?((e,t)=>{var r=[];return function(){return r.length=0,Object.assign(r,arguments),((e,t,r)=>e.includes("j")?((e,t,r)=>{var n=i["dynCall_"+e];return r&&r.length?n.apply(null,[t].concat(r)):n.call(null,t)})(e,t,r):je(t).apply(null,r))(e,t,r)}})(e,t):je(t);return"function"!=typeof r&&Te(`unknown function pointer with signature ${e}: ${t}`),r},ze=e=>{var t=_t(e),r=Se(t);return vt(t),r},Ue=(e,t,r)=>{switch(t){case 1:return r?e=>v[0|e]:e=>g[0|e];case 2:return r?e=>y[e>>1]:e=>_[e>>1];case 4:return r?e=>w[e>>2]:e=>E[e>>2];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}};function He(e){return this.fromWireType(E[e>>2])}var $e,Be="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,Ve=(e,t)=>{for(var r=e,n=r>>1,o=n+t/2;!(n>=o)&&_[n];)++n;if((r=n<<1)-e>32&&Be)return Be.decode(g.subarray(e,r));for(var i="",a=0;!(a>=t/2);++a){var s=y[e+2*a>>1];if(0==s)break;i+=String.fromCharCode(s)}return i},Ge=(e,t,r)=>{if(void 0===r&&(r=2147483647),r<2)return 0;for(var n=t,o=(r-=2)<2*e.length?r/2:e.length,i=0;i<o;++i){var a=e.charCodeAt(i);y[t>>1]=a,t+=2}return y[t>>1]=0,t-n},Je=e=>2*e.length,Ye=(e,t)=>{for(var r=0,n="";!(r>=t/4);){var o=w[e+4*r>>2];if(0==o)break;if(++r,o>=65536){var i=o-65536;n+=String.fromCharCode(55296|i>>10,56320|1023&i)}else n+=String.fromCharCode(o)}return n},qe=(e,t,r)=>{if(void 0===r&&(r=2147483647),r<4)return 0;for(var n=t,o=n+r-4,i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++i)),w[t>>2]=a,(t+=4)+4>o)break}return w[t>>2]=0,t-n},Xe=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&++r,t+=4}return t},Ze=(e,t)=>{var r=_e[e];return void 0===r&&Te(t+" has unknown type "+ze(e)),r},Qe={},Ke=e=>{var t=Qe[e];return void 0===t?Se(e):t},et=[],tt=()=>{if("object"==typeof globalThis)return globalThis;function e(e){e.$$$embind_global$$$=e;var t="object"==typeof $$$embind_global$$$&&e.$$$embind_global$$$==e;return t||delete e.$$$embind_global$$$,t}if("object"==typeof $$$embind_global$$$)return $$$embind_global$$$;if("object"==typeof o.c&&e(o.c)?$$$embind_global$$$=o.c:"object"==typeof self&&e(self)&&($$$embind_global$$$=self),"object"==typeof $$$embind_global$$$)return $$$embind_global$$$;throw Error("unable to get global object.")},rt=e=>{var t=(e-h.buffer.byteLength+65535)/65536;try{return h.grow(t),O(),1}catch(e){}},nt={},ot=()=>{if(!ot.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:c||"./this.program"};for(var t in nt)void 0===nt[t]?delete e[t]:e[t]=nt[t];var r=[];for(var t in e)r.push(`${t}=${e[t]}`);ot.strings=r}return ot.strings},it=e=>e%4==0&&(e%100!=0||e%400==0),at=[31,29,31,30,31,30,31,31,30,31,30,31],st=[31,28,31,30,31,30,31,31,30,31,30,31],lt=(e,t)=>{e<128?t.push(e):t.push(e%128|128,e>>7)},ct=[],dt=(e,t)=>{De.set(e,t),Me[e]=De.get(e)},ut=function(e,t,r,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=ce.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=n},pt=365,ht=146;Object.defineProperties(ut.prototype,{read:{get:function(){return(this.mode&pt)===pt},set:function(e){e?this.mode|=pt:this.mode&=~pt}},write:{get:function(){return(this.mode&ht)===ht},set:function(e){e?this.mode|=ht:this.mode&=~ht}},isFolder:{get:function(){return ce.isDir(this.mode)}},isDevice:{get:function(){return ce.isChrdev(this.mode)}}}),ce.FSNode=ut,ce.createPreloadedFile=(e,t,r,n,o,i,a,s,l,c)=>{var d=t?X.resolve(Y.join2(e,t)):e;function u(r){function u(r){c&&c(),s||((e,t,r,n,o,i)=>{ce.createDataFile(e,t,r,n,o,i)})(e,t,r,n,o,l),i&&i(),I()}((e,t,r,n)=>{"undefined"!=typeof Browser&&Browser.init();var o=!1;return se.forEach((i=>{o||i.canHandle(t)&&(i.handle(e,t,r,n),o=!0)})),o})(r,d,u,(()=>{a&&a(),I()}))||u(r)}L(),"string"==typeof r?ae(r,(e=>u(e)),a):u(r)},ce.staticInit(),i.FS_createPath=ce.createPath,i.FS_createDataFile=ce.createDataFile,i.FS_createPreloadedFile=ce.createPreloadedFile,i.FS_unlink=ce.unlink,i.FS_createLazyFile=ce.createLazyFile,i.FS_createDevice=ce.createDevice,me=i.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},(()=>{for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);ve=e})(),ge=i.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},Object.assign(Oe.prototype,{get(e){return this.allocated[e]},has(e){return void 0!==this.allocated[e]},allocate(e){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=e,t},free(e){this.allocated[e]=void 0,this.freelist.push(e)}}),Ce.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),Ce.reserved=Ce.allocated.length,i.count_emval_handles=()=>{for(var e=0,t=Ce.reserved;t<Ce.allocated.length;++t)void 0!==Ce.allocated[t]&&++e;return e},Re=i.UnboundTypeError=((e,t)=>{var r=function(e,t){return e=(e=>{if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=48&&t<=57?`_${e}`:e})(e),{[e]:function(){return t.apply(this,arguments)}}[e]}(t,(function(e){this.name=t,this.message=e;var r=new Error(e).stack;void 0!==r&&(this.stack=this.toString()+"\n"+r.replace(/^Error(:[^\n]*)?\n/,""))}));return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:`${this.name}: ${this.message}`},r})(Error,"UnboundTypeError");var ft={i:(e,t,r)=>{throw new J(e).init(t,r),e},x:function(e,t,r){ue.varargs=r;try{var n=ue.getStreamFromFD(e);switch(t){case 0:if((o=ue.get())<0)return-28;for(;ce.streams[o];)o++;return ce.createStream(n,o).fd;case 1:case 2:case 6:case 7:return 0;case 3:return n.flags;case 4:var o=ue.get();return n.flags|=o,0;case 5:return o=ue.getp(),y[o+0>>1]=2,0;case 16:case 8:default:return-28;case 9:return w[yt()>>2]=28,-1}}catch(e){if(void 0===ce||"ErrnoError"!==e.name)throw e;return-e.errno}},N:function(e,t,r){ue.varargs=r;try{var n=ue.getStreamFromFD(e);switch(t){case 21509:case 21510:case 21511:case 21512:case 21524:case 21515:return n.tty?0:-59;case 21505:if(!n.tty)return-59;if(n.tty.ops.ioctl_tcgets){var o=n.tty.ops.ioctl_tcgets(n),i=ue.getp();w[i>>2]=o.c_iflag||0,w[i+4>>2]=o.c_oflag||0,w[i+8>>2]=o.c_cflag||0,w[i+12>>2]=o.c_lflag||0;for(var a=0;a<32;a++)v[i+a+17|0]=o.c_cc[a]||0;return 0}return 0;case 21506:case 21507:case 21508:if(!n.tty)return-59;if(n.tty.ops.ioctl_tcsets){i=ue.getp();var s=w[i>>2],l=w[i+4>>2],c=w[i+8>>2],d=w[i+12>>2],u=[];for(a=0;a<32;a++)u.push(v[i+a+17|0]);return n.tty.ops.ioctl_tcsets(n.tty,t,{c_iflag:s,c_oflag:l,c_cflag:c,c_lflag:d,c_cc:u})}return 0;case 21519:return n.tty?(i=ue.getp(),w[i>>2]=0,0):-59;case 21520:return n.tty?-28:-59;case 21531:return i=ue.getp(),ce.ioctl(n,t,i);case 21523:if(!n.tty)return-59;if(n.tty.ops.ioctl_tiocgwinsz){var p=n.tty.ops.ioctl_tiocgwinsz(n.tty);i=ue.getp(),y[i>>1]=p[0],y[i+2>>1]=p[1]}return 0;default:return-28}}catch(e){if(void 0===ce||"ErrnoError"!==e.name)throw e;return-e.errno}},O:function(e,t,r,n){ue.varargs=n;try{t=ue.getStr(t),t=ue.calculateAt(e,t);var o=n?ue.get():0;return ce.open(t,r,o).fd}catch(e){if(void 0===ce||"ErrnoError"!==e.name)throw e;return-e.errno}},V:e=>{var t=pe[e];delete pe[e];var r=t.rawConstructor,n=t.rawDestructor,o=t.fields,i=o.map((e=>e.getterReturnType)).concat(o.map((e=>e.setterArgumentType)));be([e],i,(e=>{var i={};return o.forEach(((t,r)=>{var n=t.fieldName,a=e[r],s=t.getter,l=t.getterContext,c=e[r+o.length],d=t.setter,u=t.setterContext;i[n]={read:e=>a.fromWireType(s(l,e)),write:(e,t)=>{var r=[];d(u,e,c.toWireType(r,t)),he(r)}}})),[{name:t.name,fromWireType:e=>{var t={};for(var r in i)t[r]=i[r].read(e);return n(e),t},toWireType:(e,t)=>{for(var o in i)if(!(o in t))throw new TypeError(`Missing field: "${o}"`);var a=r();for(o in i)i[o].write(a,t[o]);return null!==e&&e.push(n,a),a},argPackAdvance:8,readValueFromPointer:fe,destructorFunction:n}]}))},G:(e,t,r,n,o)=>{},R:(e,t,r,n)=>{Ae(e,{name:t=Se(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?r:n},argPackAdvance:8,readValueFromPointer:function(e){return this.fromWireType(g[e])},destructorFunction:null})},Q:(e,t)=>{Ae(e,{name:t=Se(t),fromWireType:e=>{var t=Pe(e);return xe(e),t},toWireType:(e,t)=>Fe(t),argPackAdvance:8,readValueFromPointer:fe,destructorFunction:null})},z:(e,t,r)=>{Ae(e,{name:t=Se(t),fromWireType:e=>e,toWireType:(e,t)=>t,argPackAdvance:8,readValueFromPointer:ke(t,r),destructorFunction:null})},r:(e,t,r,n,o,i,a)=>{var s=((e,t)=>{for(var r=[],n=0;n<e;n++)r.push(E[t+4*n>>2]);return r})(t,r);e=(e=>{const t=(e=e.trim()).indexOf("(");return-1!==t?(A(")"==e[e.length-1],"Parentheses for argument names should match."),e.substr(0,t)):e})(e=Se(e)),o=We(n,o),Ie(e,(function(){((e,t)=>{var r=[],n={};throw t.forEach((function e(t){n[t]||_e[t]||(we[t]?we[t].forEach(e):(r.push(t),n[t]=!0))})),new Re(`${e}: `+r.map(ze).join([", "]))})(`Cannot call ${e} due to unbound types`,s)}),t-1),be([],s,(function(r){var n=[r[0],null].concat(r.slice(1));return Ne(e,function(e,t,r,n,o){var i=t.length;i<2&&Te("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var a=null!==t[1]&&!1,s=!1,l=1;l<t.length;++l)if(null!==t[l]&&void 0===t[l].destructorFunction){s=!0;break}var c="void"!==t[0].name,d=i-2,u=new Array(d),p=[],h=[];return function(){var r;arguments.length!==d&&Te(`function ${e} called with ${arguments.length} arguments, expected ${d}`),h.length=0,p.length=a?2:1,p[0]=o,a&&(r=t[1].toWireType(h,this),p[1]=r);for(var i=0;i<d;++i)u[i]=t[i+2].toWireType(h,arguments[i]),p.push(u[i]);return function(e){if(s)he(h);else for(var n=a?1:2;n<t.length;n++){var o=1===n?r:u[n-2];null!==t[n].destructorFunction&&t[n].destructorFunction(o)}if(c)return t[0].fromWireType(e)}(n.apply(null,p))}}(e,n,0,o,i),t-1),[]}))},c:(e,t,r,n,o)=>{t=Se(t);var i=e=>e;if(0===n){var a=32-8*r;i=e=>e<<a>>>a}var s=t.includes("unsigned");Ae(e,{name:t,fromWireType:i,toWireType:s?function(e,t){return this.name,t>>>0}:function(e,t){return this.name,t},argPackAdvance:8,readValueFromPointer:Ue(t,r,0!==n),destructorFunction:null})},b:(e,t,r)=>{var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function o(e){var t=E[e>>2],r=E[e+4>>2];return new n(v.buffer,r,t)}Ae(e,{name:r=Se(r),fromWireType:o,argPackAdvance:8,readValueFromPointer:o},{ignoreDuplicateRegistrations:!0})},y:(e,t)=>{var r="std::string"===(t=Se(t));Ae(e,{name:t,fromWireType(e){var t,n=E[e>>2],o=e+4;if(r)for(var i=o,a=0;a<=n;++a){var s=o+a;if(a==n||0==g[s]){var l=de(i,s-i);void 0===t?t=l:(t+=String.fromCharCode(0),t+=l),i=s+1}}else{var c=new Array(n);for(a=0;a<n;++a)c[a]=String.fromCharCode(g[o+a]);t=c.join("")}return vt(e),t},toWireType(e,t){var n;t instanceof ArrayBuffer&&(t=new Uint8Array(t));var o="string"==typeof t;o||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||Te("Cannot pass non-string to std::string"),n=r&&o?ee(t):t.length;var i=gt(4+n+1),a=i+4;if(E[i>>2]=n,r&&o)((e,t,r)=>{te(e,g,t,r)})(t,a,n+1);else if(o)for(var s=0;s<n;++s){var l=t.charCodeAt(s);l>255&&(vt(a),Te("String has UTF-16 code units that do not fit in 8 bits")),g[a+s]=l}else for(s=0;s<n;++s)g[a+s]=t[s];return null!==e&&e.push(vt,i),i},argPackAdvance:8,readValueFromPointer:He,destructorFunction(e){vt(e)}})},p:(e,t,r)=>{var n,o,i,a,s;r=Se(r),2===t?(n=Ve,o=Ge,a=Je,i=()=>_,s=1):4===t&&(n=Ye,o=qe,a=Xe,i=()=>E,s=2),Ae(e,{name:r,fromWireType:e=>{for(var r,o=E[e>>2],a=i(),l=e+4,c=0;c<=o;++c){var d=e+4+c*t;if(c==o||0==a[d>>s]){var u=n(l,d-l);void 0===r?r=u:(r+=String.fromCharCode(0),r+=u),l=d+t}}return vt(e),r},toWireType:(e,n)=>{"string"!=typeof n&&Te(`Cannot pass non-string to C++ string type ${r}`);var i=a(n),l=gt(4+i+t);return E[l>>2]=i>>s,o(n,l+4,i+t),null!==e&&e.push(vt,l),l},argPackAdvance:8,readValueFromPointer:fe,destructorFunction(e){vt(e)}})},W:(e,t,r,n,o,i)=>{pe[e]={name:Se(t),rawConstructor:We(r,n),rawDestructor:We(o,i),fields:[]}},k:(e,t,r,n,o,i,a,s,l,c)=>{pe[e].fields.push({fieldName:Se(t),getterReturnType:r,getter:We(n,o),getterContext:i,setterArgumentType:a,setter:We(s,l),setterContext:c})},S:(e,t)=>{Ae(e,{isVoid:!0,name:t=Se(t),argPackAdvance:0,fromWireType:()=>{},toWireType:(e,t)=>{}})},U:e=>{do{var t=E[e>>2],r=E[(e+=4)>>2],n=E[(e+=4)>>2];e+=4;var o=de(t);ce.createPath("/",Y.dirname(o),!0,!0),ce.createDataFile(o,null,v.subarray(n,n+r),!0,!0,!0)}while(E[e>>2])},I:()=>{throw 1/0},Y:(e,t,r)=>{e=Pe(e),t=Ze(t,"emval::as");var n=[],o=Fe(n);return E[r>>2]=o,t.toWireType(n,e)},A:(e,t,r,n,o)=>{var i=[],a=(e=et[e])(t=Pe(t),r=Ke(r),i,o);return i.length&&(E[n>>2]=Fe(i)),a},a:xe,Z:e=>0===e?Fe(tt()):(e=Ke(e),Fe(tt()[e])),B:(e,t)=>{var r=((e,t)=>{for(var r=new Array(e),n=0;n<e;++n)r[n]=Ze(E[t+4*n>>2],"parameter "+n);return r})(e,t),n=r.shift();e--;var o=new Array(e);return(e=>{var t=et.length;return et.push(e),t})(((t,i,a,s)=>{for(var l=0,c=0;c<e;++c)o[c]=r[c].readValueFromPointer(s+l),l+=r[c].argPackAdvance;var d=t[i].apply(t,o);for(c=0;c<e;++c)r[c].deleteObject&&r[c].deleteObject(o[c]);return n.toWireType(a,d)}))},m:(e,t)=>(e=Pe(e),t=Pe(t),Fe(e[t])),g:e=>{e>4&&(Ce.get(e).refcount+=1)},C:()=>Fe([]),h:e=>Fe(Ke(e)),s:e=>{var t=Pe(e);he(t),xe(e)},X:(e,t,r)=>{e=Pe(e),t=Pe(t),r=Pe(r),e[t]=r},l:(e,t)=>{var r=(e=Ze(e,"_emval_take_value")).readValueFromPointer(t);return Fe(r)},q:()=>{N("")},P:(e,t,r)=>g.copyWithin(e,t,t+r),J:e=>{var t=g.length,r=2147483648;if((e>>>=0)>r)return!1;for(var n=(e,t)=>e+(t-e%t)%t,o=1;o<=4;o*=2){var i=t*(1+.2/o);i=Math.min(i,e+100663296);var a=Math.min(r,n(Math.max(e,i),65536));if(rt(a))return!0}return!1},K:(e,t)=>{var r=0;return ot().forEach(((n,o)=>{var i=t+r;E[e+4*o>>2]=i,((e,t)=>{for(var r=0;r<e.length;++r)v[0|t++]=e.charCodeAt(r);v[0|t]=0})(n,i),r+=n.length+1})),0},L:(e,t)=>{var r=ot();E[e>>2]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),E[t>>2]=n,0},T:(e,t)=>{(e=>{G||(i.onExit&&i.onExit(e),T=!0),d(e,new B(e))})(e)},v:function(e){try{var t=ue.getStreamFromFD(e);return ce.close(t),0}catch(e){if(void 0===ce||"ErrnoError"!==e.name)throw e;return e.errno}},M:function(e,t,r,n){try{var o=((e,t,r)=>{for(var n=0,o=0;o<r;o++){var i=E[t>>2],a=E[t+4>>2];t+=8;var s=ce.read(e,v,i,a,undefined);if(s<0)return-1;if(n+=s,s<a)break}return n})(ue.getStreamFromFD(e),t,r);return E[n>>2]=o,0}catch(e){if(void 0===ce||"ErrnoError"!==e.name)throw e;return e.errno}},F:function(e,t,r,n,o){var i=((e,t)=>t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN)(t,r);try{if(isNaN(i))return 61;var a=ue.getStreamFromFD(e);return ce.llseek(a,i,n),W=[a.position>>>0,(j=a.position,+Math.abs(j)>=1?j>0?+Math.floor(j/4294967296)>>>0:~~+Math.ceil((j-+(~~j>>>0))/4294967296)>>>0:0)],w[o>>2]=W[0],w[o+4>>2]=W[1],a.getdents&&0===i&&0===n&&(a.getdents=null),0}catch(e){if(void 0===ce||"ErrnoError"!==e.name)throw e;return e.errno}},w:function(e,t,r,n){try{var o=((e,t,r)=>{for(var n=0,o=0;o<r;o++){var i=E[t>>2],a=E[t+4>>2];t+=8;var s=ce.write(e,v,i,a,undefined);if(s<0)return-1;n+=s}return n})(ue.getStreamFromFD(e),t,r);return E[n>>2]=o,0}catch(e){if(void 0===ce||"ErrnoError"!==e.name)throw e;return e.errno}},n:function(e,t){var r=bt();try{return je(e)(t)}catch(e){if(St(r),e!==e+0)throw e;Et(1,0)}},j:function(e,t,r){var n=bt();try{return je(e)(t,r)}catch(e){if(St(n),e!==e+0)throw e;Et(1,0)}},o:function(e,t,r,n){var o=bt();try{return je(e)(t,r,n)}catch(e){if(St(o),e!==e+0)throw e;Et(1,0)}},t:function(e,t,r,n,o){var i=bt();try{return je(e)(t,r,n,o)}catch(e){if(St(i),e!==e+0)throw e;Et(1,0)}},E:function(e,t,r,n,o,i,a,s,l,c){var d=bt();try{return je(e)(t,r,n,o,i,a,s,l,c)}catch(e){if(St(d),e!==e+0)throw e;Et(1,0)}},u:function(e){var t=bt();try{je(e)()}catch(e){if(St(t),e!==e+0)throw e;Et(1,0)}},d:function(e,t){var r=bt();try{je(e)(t)}catch(e){if(St(r),e!==e+0)throw e;Et(1,0)}},D:function(e,t,r,n){var o=bt();try{je(e)(t,r,n)}catch(e){if(St(o),e!==e+0)throw e;Et(1,0)}},e:function(e,t,r){var n=bt();try{je(e)(t,r)}catch(e){if(St(n),e!==e+0)throw e;Et(1,0)}},f:function(e,t,r,n){var o=bt();try{je(e)(t,r,n)}catch(e){if(St(o),e!==e+0)throw e;Et(1,0)}},H:(e,t,r,n,o)=>((e,t,r,n)=>{var o=E[n+40>>2],i={tm_sec:w[n>>2],tm_min:w[n+4>>2],tm_hour:w[n+8>>2],tm_mday:w[n+12>>2],tm_mon:w[n+16>>2],tm_year:w[n+20>>2],tm_wday:w[n+24>>2],tm_yday:w[n+28>>2],tm_isdst:w[n+32>>2],tm_gmtoff:w[n+36>>2],tm_zone:o?de(o):""},a=de(r),s={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var l in s)a=a.replace(new RegExp(l,"g"),s[l]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["January","February","March","April","May","June","July","August","September","October","November","December"];function u(e,t,r){for(var n="number"==typeof e?e.toString():e||"";n.length<t;)n=r[0]+n;return n}function p(e,t){return u(e,t,"0")}function h(e,t){function r(e){return e<0?-1:e>0?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function f(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function m(e){var t=((e,t)=>{for(var r=new Date(e.getTime());t>0;){var n=it(r.getFullYear()),o=r.getMonth(),i=(n?at:st)[o];if(!(t>i-r.getDate()))return r.setDate(r.getDate()+t),r;t-=i-r.getDate()+1,r.setDate(1),o<11?r.setMonth(o+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1))}return r})(new Date(e.tm_year+1900,0,1),e.tm_yday),r=new Date(t.getFullYear(),0,4),n=new Date(t.getFullYear()+1,0,4),o=f(r),i=f(n);return h(o,t)<=0?h(i,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var g={"%a":e=>c[e.tm_wday].substring(0,3),"%A":e=>c[e.tm_wday],"%b":e=>d[e.tm_mon].substring(0,3),"%B":e=>d[e.tm_mon],"%C":e=>p((e.tm_year+1900)/100|0,2),"%d":e=>p(e.tm_mday,2),"%e":e=>u(e.tm_mday,2," "),"%g":e=>m(e).toString().substring(2),"%G":e=>m(e),"%H":e=>p(e.tm_hour,2),"%I":e=>{var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),p(t,2)},"%j":e=>p(e.tm_mday+((e,t)=>{for(var r=0,n=0;n<=t;r+=e[n++]);return r})(it(e.tm_year+1900)?at:st,e.tm_mon-1),3),"%m":e=>p(e.tm_mon+1,2),"%M":e=>p(e.tm_min,2),"%n":()=>"\n","%p":e=>e.tm_hour>=0&&e.tm_hour<12?"AM":"PM","%S":e=>p(e.tm_sec,2),"%t":()=>"\t","%u":e=>e.tm_wday||7,"%U":e=>{var t=e.tm_yday+7-e.tm_wday;return p(Math.floor(t/7),2)},"%V":e=>{var t=Math.floor((e.tm_yday+7-(e.tm_wday+6)%7)/7);if((e.tm_wday+371-e.tm_yday-2)%7<=2&&t++,t){if(53==t){var r=(e.tm_wday+371-e.tm_yday)%7;4==r||3==r&&it(e.tm_year)||(t=1)}}else{t=52;var n=(e.tm_wday+7-e.tm_yday-1)%7;(4==n||5==n&&it(e.tm_year%400-1))&&t++}return p(t,2)},"%w":e=>e.tm_wday,"%W":e=>{var t=e.tm_yday+7-(e.tm_wday+6)%7;return p(Math.floor(t/7),2)},"%y":e=>(e.tm_year+1900).toString().substring(2),"%Y":e=>e.tm_year+1900,"%z":e=>{var t=e.tm_gmtoff,r=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(r?"+":"-")+String("0000"+t).slice(-4)},"%Z":e=>e.tm_zone,"%%":()=>"%"};for(var l in a=a.replace(/%%/g,"\0\0"),g)a.includes(l)&&(a=a.replace(new RegExp(l,"g"),g[l](i)));var y=re(a=a.replace(/\0\0/g,"%"),!1);return y.length>t?0:(((e,t)=>{v.set(e,t)})(y,e),y.length-1)})(e,t,r,n)},mt=function(){var e={a:ft};function t(e,t){return mt=e.exports,h=mt._,O(),De=mt.aa,function(e){R.unshift(e)}(mt.$),I(),mt}if(L(),i.instantiateWasm)try{return i.instantiateWasm(e,t)}catch(e){m(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return function(e,t,r,n){return e||"function"!=typeof WebAssembly.instantiateStreaming||U(t)||"function"!=typeof fetch?$(t,r,n):fetch(t,{credentials:"same-origin"}).then((e=>WebAssembly.instantiateStreaming(e,r).then(n,(function(e){return m(`wasm streaming compile failed: ${e}`),m("falling back to ArrayBuffer instantiation"),$(t,r,n)}))))}(p,M,e,(function(e){t(e.instance)})).catch(n),{}}(),vt=i._free=e=>(vt=i._free=mt.ba)(e),gt=i._malloc=e=>(gt=i._malloc=mt.ca)(e),yt=()=>(yt=mt.da)(),_t=e=>(_t=mt.ea)(e);i.__embind_initialize_bindings=()=>(i.__embind_initialize_bindings=mt.fa)();var wt,Et=(e,t)=>(Et=mt.ga)(e,t),bt=()=>(bt=mt.ha)(),St=e=>(St=mt.ia)(e),Tt=e=>(Tt=mt.ja)(e);function At(){function e(){wt||(wt=!0,i.calledRun=!0,T||(i.noFSInit||ce.init.initialized||ce.init(),ce.ignorePermissions=!1,V(R),r(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),function(){if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)P(i.postRun.shift());V(C)}()))}F>0||(function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)x(i.preRun.shift());V(D)}(),F>0||(i.setStatus?(i.setStatus("Running..."),setTimeout((function(){setTimeout((function(){i.setStatus("")}),1),e()}),1)):e()))}if(i.dynCall_viji=(e,t,r,n,o)=>(i.dynCall_viji=mt.ka)(e,t,r,n,o),i.dynCall_ji=(e,t)=>(i.dynCall_ji=mt.la)(e,t),i.dynCall_jiji=(e,t,r,n,o)=>(i.dynCall_jiji=mt.ma)(e,t,r,n,o),i.dynCall_viijii=(e,t,r,n,o,a,s)=>(i.dynCall_viijii=mt.na)(e,t,r,n,o,a,s),i.dynCall_iiiiij=(e,t,r,n,o,a,s)=>(i.dynCall_iiiiij=mt.oa)(e,t,r,n,o,a,s),i.dynCall_iiiiijj=(e,t,r,n,o,a,s,l,c)=>(i.dynCall_iiiiijj=mt.pa)(e,t,r,n,o,a,s,l,c),i.dynCall_iiiiiijj=(e,t,r,n,o,a,s,l,c,d)=>(i.dynCall_iiiiiijj=mt.qa)(e,t,r,n,o,a,s,l,c,d),i.___emscripten_embedded_file_data=1275400,i.addRunDependency=L,i.removeRunDependency=I,i.FS_createPath=ce.createPath,i.FS_createLazyFile=ce.createLazyFile,i.FS_createDevice=ce.createDevice,i.addFunction=(e,t)=>{var r=(e=>($e||($e=new WeakMap,((e,t)=>{if($e)for(var r=0;r<0+t;r++){var n=je(r);n&&$e.set(n,r)}})(0,De.length)),$e.get(e)||0))(e);if(r)return r;var n=(()=>{if(ct.length)return ct.pop();try{De.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return De.length-1})();try{dt(n,e)}catch(r){if(!(r instanceof TypeError))throw r;var o=((e,t)=>{if("function"==typeof WebAssembly.Function)return new WebAssembly.Function((e=>{for(var t={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},r={parameters:[],results:"v"==e[0]?[]:[t[e[0]]]},n=1;n<e.length;++n)r.parameters.push(t[e[n]]);return r})(t),e);var r=[1];((e,t)=>{var r=e.slice(0,1),n=e.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111};t.push(96),lt(n.length,t);for(var i=0;i<n.length;++i)t.push(o[n[i]]);"v"==r?t.push(0):t.push(1,o[r])})(t,r);var n=[0,97,115,109,1,0,0,0,1];lt(r.length,n),n.push.apply(n,r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var o=new WebAssembly.Module(new Uint8Array(n));return new WebAssembly.Instance(o,{e:{f:e}}).exports.f})(e,t);dt(n,o)}return $e.set(e,n),n},i.UTF8ToString=de,i.FS_createPreloadedFile=ce.createPreloadedFile,i.FS_createDataFile=ce.createDataFile,i.FS_unlink=ce.unlink,k=function e(){wt||At(),wt||(k=e)},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return At(),e.ready},e.exports=r),i.exports;var e,t,r}()),s=Object.freeze(Object.defineProperty({__proto__:null,default:a},Symbol.toStringTag,{value:"Module"}))},77802:(e,t,r)=>{r.d(t,{q:()=>f,h:()=>m});var n=r(80002),o=r(69952),i=r(92121),a=r(19635),s=r(41014),l=r(19778);function c(e){return e.pattern.map((t=>Math.round(t*e.pixelRatio)))}function d(e){return c(e).reduce(((e,t)=>Math.max(e,t)))}r(39637),r(68716),r(22497),r(88416);var u=r(74772),p=r(76982);const h=(0,p.vt)();function f(e,t){t.stippleEnabled?function(e,t){const r=!(t.draped&&t.stipplePreferContinuous),{vertex:c,fragment:f}=e;f.include(n.W),t.draped||((0,o.yu)(c,t),c.uniforms.add(new a.m("worldToScreenPerDistanceRatio",((e,t)=>1/t.camera.perScreenPixelRatio))),c.code.add(s.H`float computeWorldToScreenRatio(vec3 segmentCenter) {
float segmentDistanceToCamera = length(segmentCenter - cameraPosition);
return worldToScreenPerDistanceRatio / segmentDistanceToCamera;
}`)),e.varyings.add("vStippleDistance","float"),e.varyings.add("vStippleDistanceLimits","vec2"),e.varyings.add("vStipplePatternStretch","float"),c.code.add(s.H`
    float discretizeWorldToScreenRatio(float worldToScreenRatio) {
      float step = ${v};

      float discreteWorldToScreenRatio = log(worldToScreenRatio);
      discreteWorldToScreenRatio = ceil(discreteWorldToScreenRatio / step) * step;
      discreteWorldToScreenRatio = exp(discreteWorldToScreenRatio);
      return discreteWorldToScreenRatio;
    }
  `),c.code.add(s.H`vec2 computeStippleDistanceLimits(float startPseudoScreen, float segmentLengthPseudoScreen, float segmentLengthScreen, float patternLength) {`),c.code.add(s.H`
    if (segmentLengthPseudoScreen >= ${r?"patternLength":"1e4"}) {
  `),(0,o.Nz)(c),c.code.add(s.H`float repetitions = segmentLengthScreen / (patternLength * pixelRatio);
float flooredRepetitions = max(1.0, floor(repetitions + 0.5));
float segmentLengthScreenRounded = flooredRepetitions * patternLength;
float stretch = repetitions / flooredRepetitions;
vStipplePatternStretch = max(0.75, stretch);
return vec2(0.0, segmentLengthScreenRounded);
}
return vec2(startPseudoScreen, startPseudoScreen + segmentLengthPseudoScreen);
}`),f.uniforms.add(new l.N("stipplePatternTexture",(e=>e.stippleTexture)),new a.m("stipplePatternSDFNormalizer",(e=>function(e){return e?(Math.floor(.5*(d(e)-1))+.5)/e.pixelRatio:1}(e.stipplePattern))),new a.m("stipplePatternPixelSizeInv",(e=>1/m(e)))),f.code.add(s.H`float getStippleSDF(out bool isClamped) {
float stippleDistanceClamped = clamp(vStippleDistance, vStippleDistanceLimits.x, vStippleDistanceLimits.y);
vec2 aaCorrectedLimits = vStippleDistanceLimits + vec2(1.0, -1.0) / gl_FragCoord.w;
isClamped = vStippleDistance < aaCorrectedLimits.x || vStippleDistance > aaCorrectedLimits.y;
float u = stippleDistanceClamped * gl_FragCoord.w * stipplePatternPixelSizeInv * vLineSizeInv;
u = fract(u);
float encodedSDF = rgba2float(texture(stipplePatternTexture, vec2(u, 0.5)));
float sdf = (encodedSDF * 2.0 - 1.0) * stipplePatternSDFNormalizer;
return (sdf - 0.5) * vStipplePatternStretch + 0.5;
}
float getStippleSDF() {
bool ignored;
return getStippleSDF(ignored);
}
float getStippleAlpha() {
bool isClamped;
float stippleSDF = getStippleSDF(isClamped);
float antiAliasedResult = clamp(stippleSDF * vLineWidth + 0.5, 0.0, 1.0);
return isClamped ? floor(antiAliasedResult + 0.5) : antiAliasedResult;
}`),t.stippleOffColorEnabled?(f.uniforms.add(new i.E("stippleOffColor",(e=>function(e){return null==e?p.uY:4===e.length?e:(0,u.s)(h,e[0],e[1],e[2],1)}(e.stippleOffColor)))),f.code.add(s.H`#define discardByStippleAlpha(stippleAlpha, threshold) {}
#define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)`)):f.code.add(s.H`#define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }
#define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)`)}(e,t):function(e){e.fragment.code.add(s.H`float getStippleAlpha() { return 1.0; }
#define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}
#define blendStipple(color, _stippleAlpha_) color`)}(e)}function m(e){const t=e.stipplePattern;return t?function(e){if(null==e)return 1;const t=c(e);return Math.floor(t.reduce(((e,t)=>e+t)))}(e.stipplePattern)/t.pixelRatio:1}const v=s.H.float(.4)},93129:(e,t,r)=>{r.d(t,{F:()=>i});var n=r(69172),o=r(35542);class i{constructor(){this._meterUnitOffset=0,this._renderUnitOffset=0,this._unit="meters",this._metersPerElevationInfoUnit=1,this._featureExpressionInfoContext=null,this.centerPointInElevationSR=null,this.mode=null}get featureExpressionInfoContext(){return this._featureExpressionInfoContext}get meterUnitOffset(){return this._meterUnitOffset}get unit(){return this._unit}set unit(e){this._unit=e,this._metersPerElevationInfoUnit=(0,n.Ao)(e)}get requiresSampledElevationInfo(){return"absolute-height"!==this.mode}reset(){this.mode=null,this._meterUnitOffset=0,this._renderUnitOffset=0,this._featureExpressionInfoContext=null,this.unit="meters"}set offsetMeters(e){this._meterUnitOffset=e,this._renderUnitOffset=0}set offsetElevationInfoUnits(e){this._meterUnitOffset=e*this._metersPerElevationInfoUnit,this._renderUnitOffset=0}addOffsetRenderUnits(e){this._renderUnitOffset+=e}geometryZWithOffset(e,t){const r=this.calculateOffsetRenderUnits(t);return null!=this.featureExpressionInfoContext?r:e+r}calculateOffsetRenderUnits(e){let t=this._meterUnitOffset;const r=this.featureExpressionInfoContext;return null!=r&&(t+=(0,o.g7)(r)*this._metersPerElevationInfoUnit),t/e.unitInMeters+this._renderUnitOffset}setFromElevationInfo(e){this.mode=e.mode,this.unit=(0,n.Tg)(e.unit)?e.unit:"meters",this.offsetElevationInfoUnits=e.offset??0}updateFeatureExpressionInfoContext(e,t,r){if(null==e)return void(this._featureExpressionInfoContext=null);const n=e?.arcade;n&&null!=t&&null!=r?(this._featureExpressionInfoContext=(0,o.o8)(e),(0,o.gf)(this._featureExpressionInfoContext,(0,o.VG)(n.modules,t,r))):this._featureExpressionInfoContext=e}static fromElevationInfo(e){const t=new i;return null!=e&&t.setFromElevationInfo(e),t}}},96024:(e,t,r)=>{r.d(t,{f:()=>i});var n=r(19913);class o{constructor(e,t){this.vec3=e,this.id=t}}function i(e,t,r,i){return new o((0,n.fA)(e,t,r),i)}}}]);